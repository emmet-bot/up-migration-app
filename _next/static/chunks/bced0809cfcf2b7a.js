(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,604647,292227,354157,637824,757758,747512,e=>{"use strict";let t,n;e.s(["createAppKit",()=>eI],604647);var r=e.i(227302),i=e.i(401564),o=e.i(90068),s=e.i(886259),a=e.i(971080),l=e.i(149454),c=e.i(360334),d=e.i(653157),u=e.i(77277),h=e.i(221728),C=e.i(218454),p=e.i(564126),m=e.i(851887),g=e.i(960398),f=e.i(82283),w=e.i(462579),v=e.i(758331),E=e.i(639403),A=e.i(535568),N=e.i(769718),y=e.i(16555),T=e.i(810923),b=e.i(979484),I=e.i(542991);class U{static getInstance({projectId:e,chainId:t,enableLogger:n,onTimeout:r,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:s}){let{metadata:a,sdkVersion:l,sdkType:c}=f.OptionsController.getSnapshot();return U.instance||(U.instance=new I.W3mFrameProvider({projectId:e,chainId:t,enableLogger:n,onTimeout:r,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:s,enableCloudAuthAccount:!!f.OptionsController.state.remoteFeatures?.emailCapture,metadata:a,sdkVersion:l,sdkType:c})),U.instance}}e.s(["W3mFrameProviderSingleton",()=>U],292227);var O=e.i(971342),S=e.i(681285),P=e.i(150576),k=e.i(465166),_=e.i(436220),R=e.i(24742),L=e.i(210087),W=e.i(770850),M=e.i(313730),F=e.i(803468),D=e.i(230121),x=e.i(194712),j=e.i(811424),H=e.i(197730);function q(e){try{return new URL(e)}catch{return null}}let B={ton:["ton_sendMessage","ton_signData"],solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},K={RPC_ERROR_CODE:{USER_REJECTED:5e3,USER_REJECTED_METHODS:5002},getMethodsByChainNamespace:e=>B[e]||[],createDefaultNamespace(e){return{methods:this.getMethodsByChainNamespace(e),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(e,t){if(!t)return{...e};let n={...e},r=new Set;if(t.methods&&Object.keys(t.methods).forEach(e=>r.add(e)),t.chains&&Object.keys(t.chains).forEach(e=>r.add(e)),t.events&&Object.keys(t.events).forEach(e=>r.add(e)),t.rpcMap&&Object.keys(t.rpcMap).forEach(e=>{let[t]=e.split(":");t&&r.add(t)}),r.forEach(e=>{n[e]||(n[e]=this.createDefaultNamespace(e))}),t.methods&&Object.entries(t.methods).forEach(([e,t])=>{n[e]&&(n[e].methods=t)}),t.chains&&Object.entries(t.chains).forEach(([e,t])=>{n[e]&&(n[e].chains=t)}),t.events&&Object.entries(t.events).forEach(([e,t])=>{n[e]&&(n[e].events=t)}),t.rpcMap){let e=new Set;Object.entries(t.rpcMap).forEach(([t,r])=>{let[i,o]=t.split(":");i&&o&&n[i]&&(n[i].rpcMap||(n[i].rpcMap={}),e.has(i)||(n[i].rpcMap={},e.add(i)),n[i].rpcMap[o]=r)})}return n},createNamespaces(e,t){let n=e.reduce((e,t)=>{let{id:n,chainNamespace:r,rpcUrls:i}=t,o=i.default.http[0];e[r]||(e[r]=this.createDefaultNamespace(r));let s=`${r}:${n}`,a=e[r];switch(a.chains.push(s),s){case"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":a.chains.push("solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ");break;case"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1":a.chains.push("solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K")}return a?.rpcMap&&o&&(a.rpcMap[n]=o),e},{});return this.applyNamespaceOverrides(n,t)},resolveReownName:async e=>{let t=await M.EnsController.resolveName(e),n=t?.addresses?Object.values(t.addresses):[];return n[0]?.address||!1},getChainsFromNamespaces:(e={})=>Object.values(e).flatMap(e=>Array.from(new Set([...e.chains||[],...e.accounts.map(e=>{let[t,n]=e.split(":");return`${t}:${n}`})]))),isSessionEventData:e=>"object"==typeof e&&null!==e&&"id"in e&&"topic"in e&&"params"in e&&"object"==typeof e.params&&null!==e.params&&"chainId"in e.params&&"event"in e.params&&"object"==typeof e.params.event&&null!==e.params.event,isUserRejectedRequestError(e){try{if("object"==typeof e&&null!==e){let t="number"==typeof e.code,n=t&&e.code===K.RPC_ERROR_CODE.USER_REJECTED_METHODS,r=t&&e.code===K.RPC_ERROR_CODE.USER_REJECTED;return n||r}return!1}catch{return!1}},isOriginAllowed(e,t,n){let r=[...t,...n];if(0===t.length)return!0;let i=q(e);if(!i)return r.some(t=>!t.includes("*")&&t===e);if("localhost"===i.hostname||"127.0.0.1"===i.hostname)return!0;for(let t of r)if(t.includes("*")){if(function(e,t,n){let r,i,o=n,s=o.indexOf("://");-1!==s&&(r=o.slice(0,s),o=o.slice(s+3));let a=o.indexOf("/");-1!==a&&(o=o.slice(0,a));let l=o,c=l.lastIndexOf(":");-1!==c&&(i=l.slice(c+1),l=l.slice(0,c));let d=l.split(".");for(let e of d)if(e.includes("*")&&"*"!==e)return!1;let u=e.protocol.replace(/:$/u,"");if(r&&r!==u||void 0!==i&&"*"!==i&&i!==e.port)return!1;let h=function(e){let t=e.indexOf("://");if(-1===t)return null;let n=e.slice(0,t),r=t+3,i=e.indexOf("/",r);-1===i&&(i=e.length);let o=e.slice(r,i),s=o.lastIndexOf(":");return -1===s?{scheme:n,host:o}:{scheme:n,host:o.slice(0,s),port:o.slice(s+1)}}(t),C=(h?h.host:e.hostname).split(".");if(d.length!==C.length)return!1;for(let e=d.length-1;e>=0;e-=1){let t=d[e],n=C[e];if("*"!==t&&t!==n)return!1}return!0}(i,e,t))return!0}else if(function(e,t){let n,r,i;if(t.includes("://")){let n=q(t);return!!n&&n.origin===e}let{host:o,port:s}=-1===(i=(r=(n=t.split("/")).length>0&&void 0!==n[0]?n[0]:"").lastIndexOf(":"))?{host:r}:{host:r.slice(0,i),port:r.slice(i+1)},a=e.indexOf("://");if(-1!==a){let t=a+3,n=e.indexOf("/",t);-1===n&&(n=e.length);let r=e.slice(t,n);return void 0!==s?`${o}:${s}`===r:o===r.split(":")[0]}let l=q(e);return!!l&&(void 0!==s?o===l.hostname&&s===(l.port||void 0):o===l.hostname)}(e,t))return!0;return!1},listenWcProvider({universalProvider:e,namespace:t,onConnect:n,onDisconnect:r,onAccountsChanged:i,onChainChanged:o,onDisplayUri:s}){n&&e.on("connect",()=>{n(K.getWalletConnectAccounts(e,t))}),r&&e.on("disconnect",()=>{r()}),i&&e.on("accountsChanged",n=>{try{let r=e.session?.namespaces?.[t]?.accounts||[],o=e.rpcProviders?.[t]?.getDefaultChain(),s=n.map(e=>{let n=r.find(n=>n.includes(`${t}:${o}:${e}`));if(!n)return;let{chainId:i,chainNamespace:s}=P.ParseUtil.parseCaipAddress(n);return{address:e,chainId:i,chainNamespace:s}}).filter(e=>void 0!==e);s.length>0&&i(s)}catch(e){console.warn("Failed to parse accounts for namespace on accountsChanged event",t,n,e)}}),o&&e.on("chainChanged",e=>{o(e)}),s&&e.on("display_uri",e=>{s(e)})},getWalletConnectAccounts(e,t){let n=new Set,r=e?.session?.namespaces?.[t]?.accounts?.map(e=>P.ParseUtil.parseCaipAddress(e)).filter(({address:e})=>!n.has(e.toLowerCase())&&(n.add(e.toLowerCase()),!0));return r&&r.length>0?r:[]}};e.s(["WcHelpersUtil",0,K],354157),e.i(404041);var $=e.i(459088),V=e.i(334523),z=e.i(366350);let G={createLogger(e,t="error"){let n=(0,z.getDefaultLoggerOptions)({level:t}),{logger:r}=(0,z.generatePlatformLogger)({opts:n});return r.error=(...t)=>{for(let n of t)if(n instanceof Error)return void e(n,...t);e(void 0,...t)},r}};var Y=e.i(124141);let X={TOKEN_ADDRESSES_BY_SYMBOL:{USDC:{8453:Y.baseUSDC.asset,84532:Y.baseSepoliaUSDC.asset}},getTokenSymbolByAddress(e){if(!e)return;let[t]=Object.entries(X.TOKEN_ADDRESSES_BY_SYMBOL).find(([t,n])=>Object.values(n).includes(e))??[];return t}};var Q=e.i(103476),J=e.i(675107),Z=e.i(683075);let ee=[i.ConstantsUtil.CONNECTOR_ID.AUTH,i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT];class et{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=e=>g.ChainController.getCaipNetworks(e),this.getConnectorId=e=>l.ConnectorController.getConnectorId(e),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:t}){let n=this.getCaipNetworks().filter(e=>e.chainNamespace===this.namespace).find(e=>e.id.toString()===t?.toString());e&&n&&this.addConnection({connectorId:i.ConstantsUtil.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:n})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:i.ConstantsUtil.CONNECTOR_ID.AUTH,type:"AUTH",name:i.ConstantsUtil.CONNECTOR_NAMES.AUTH,provider:e,imageId:void 0,chain:this.namespace,chains:[]})}addConnector(...e){let t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(e=>!t.has(e.id)&&(t.add(e.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){let t=new Set;this.availableConnections=[...e,...this.availableConnections].filter(e=>!t.has(e.connectorId.toLowerCase())&&(t.add(e.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(t=>t.connectorId.toLowerCase()!==e.toLowerCase()),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,t){g.ChainController.setAccountProp("status",e,t)}on(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(t)}off(e,t){let n=this.eventListeners.get(e);n&&n.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){let n=this.eventListeners.get(e);n&&n.forEach(e=>e(t))}async connectWalletConnect(e){try{let e=this.getWalletConnectConnector();return{clientId:(await e.connectWalletConnect()).clientId}}catch(e){if(K.isUserRejectedRequestError(e))throw new Z.UserRejectedRequestError(e);throw e}}async switchNetwork(e){let{caipNetwork:t}=e,n=w.ProviderController.getProviderId(t.chainNamespace),r=w.ProviderController.getProvider(t.chainNamespace);if(!r)throw Error("Provider not found");if("WALLET_CONNECT"===n)return void r.setDefaultChain(t.caipNetworkId);if("AUTH"===n){let e=l.ConnectorController.getAuthConnector()?.provider;if(!e)throw Error("Auth provider not found");let n=(0,p.getPreferredAccountType)(t.chainNamespace);await e.switchNetwork({chainId:t.caipNetworkId});let r=await e.getUser({chainId:t.caipNetworkId,preferredAccountType:n});this.emit("switchNetwork",r)}}getWalletConnectConnector(){let e=this.connectors.find(e=>"walletConnect"===e.id);if(!e)throw Error("WalletConnectConnector not found");return e}onConnect(e,t){if(e.length>0){let{address:n,chainId:i}=r.CoreHelperUtil.getAccount(e[0]),o=this.getCaipNetworks().filter(e=>e.chainNamespace===this.namespace).find(e=>e.id.toString()===i?.toString()),s=this.connectors.find(e=>e.id===t);n&&(this.emit("accountChanged",{address:n,chainId:i,connector:s}),this.addConnection({connectorId:t,accounts:e.map(e=>{let{address:t}=r.CoreHelperUtil.getAccount(e);return{address:t}}),caipNetwork:o}))}}onAccountsChanged(e,t,n=!0){if(e.length>0){let{address:n}=r.CoreHelperUtil.getAccount(e[0]),o=this.getConnection({connectorId:t,connections:this.connections,connectors:this.connectors});n&&this.getConnectorId(i.ConstantsUtil.CHAIN.EVM)?.toLowerCase()===t.toLowerCase()&&this.emit("accountChanged",{address:n,chainId:o?.caipNetwork?.id,connector:o?.connector}),this.addConnection({connectorId:t,accounts:e.map(e=>{let{address:t}=r.CoreHelperUtil.getAccount(e);return{address:t}}),caipNetwork:o?.caipNetwork})}else n&&this.onDisconnect(t)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),this.getConnectorId(i.ConstantsUtil.CHAIN.EVM)?.toLowerCase()===e.toLowerCase()&&this.emitFirstAvailableConnection(),0===this.connections.length&&this.emit("disconnect")}onChainChanged(e,t){let n="string"==typeof e&&e.startsWith("0x")?parseInt(e,16).toString():e.toString(),r=this.getConnection({connectorId:t,connections:this.connections,connectors:this.connectors}),o=this.getCaipNetworks().filter(e=>e.chainNamespace===this.namespace).find(e=>e.id.toString()===n);r&&this.addConnection({connectorId:t,accounts:r.accounts,caipNetwork:o}),this.getConnectorId(i.ConstantsUtil.CHAIN.EVM)?.toLowerCase()===t.toLowerCase()&&this.emit("switchNetwork",{chainId:n})}listenProviderEvents(e,t){if(ee.includes(e))return;let n=t=>this.onAccountsChanged(t,e),r=t=>this.onChainChanged(t,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(t.on("disconnect",i),t.on("accountsChanged",n),t.on("chainChanged",r),this.providerHandlers[e]={provider:t,disconnect:i,accountsChanged:n,chainChanged:r})}removeProviderListeners(e){if(this.providerHandlers[e]){let{provider:t,disconnect:n,accountsChanged:r,chainChanged:i}=this.providerHandlers[e];t.removeListener("disconnect",n),t.removeListener("accountsChanged",r),t.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){let e=this.getConnection({connections:this.connections,connectors:this.connectors});if(e){let[t]=e.accounts;this.emit("accountChanged",{address:t?.address,chainId:e.caipNetwork?.id,connector:e.connector})}}getConnection({address:e,connectorId:t,connections:n,connectors:r}){if(t){let i=n.find(e=>e.connectorId.toLowerCase()===t.toLowerCase());if(!i)return null;let o=r.find(e=>e.id.toLowerCase()===i.connectorId.toLowerCase()),s=e?i.accounts.find(t=>t.address.toLowerCase()===e.toLowerCase()):i.accounts[0];return{...i,account:s,connector:o}}let i=n.find(e=>e.accounts.length>0&&r.some(t=>t.id.toLowerCase()===e.connectorId.toLowerCase()));if(i){let[e]=i.accounts,t=r.find(e=>e.id.toLowerCase()===i.connectorId.toLowerCase());return{...i,account:e,connector:t}}return null}}e.s(["AdapterBlueprint",()=>et],637824);class en{constructor({provider:e,namespace:t}){this.id=i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT,this.name="WalletConnect",this.type="WALLET_CONNECT",this.imageId="ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",this.getCaipNetworks=g.ChainController.getCaipNetworks.bind(g.ChainController),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=t}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){let e=this.getCaipNetworks(),t=f.OptionsController.state.universalProviderConfigOverride,n=K.createNamespaces(e,t);await this.provider.connect({optionalNamespaces:n})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){let e=this.chains.map(e=>e.caipNetworkId);return C.SIWXUtil.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:er})}}let er=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];e.s(["WalletConnectConnector",()=>en],757758);class ei extends et{async setUniversalProvider(e){if(!this.namespace)throw Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new en({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{let e=this.getWalletConnectConnector();await e.disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async writeSolanaTransaction(){return Promise.resolve({hash:""})}async getAccounts({namespace:e}){let t=this.provider;return Promise.resolve({accounts:(t?.session?.namespaces?.[e]?.accounts?.map(e=>{let[,,t]=e.split(":");return t}).filter((e,t,n)=>n.indexOf(e)===t)||[]).map(t=>r.CoreHelperUtil.createAccount(e,t,"bip122"===e?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&c.ConstantsUtil.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};let t=g.ChainController.getAccountData();if(t?.balanceLoading&&e.chainId===g.ChainController.state.activeCaipNetwork?.id)return{balance:t?.balance||"0.00",symbol:t?.balanceSymbol||""};let n=(await g.ChainController.fetchTokenBalance()).find(t=>t.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&t.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:n?.quantity.numeric||"0.00",symbol:n?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){let{provider:t,message:n,address:r}=e;if(!t)throw Error("UniversalAdapter:signMessage - provider is undefined");return{signature:g.ChainController.state.activeCaipNetwork?.chainNamespace===i.ConstantsUtil.CHAIN.SOLANA?(await t.request({method:"solana_signMessage",params:{message:Q.default.encode(new TextEncoder().encode(n)),pubkey:r}},g.ChainController.state.activeCaipNetwork?.caipNetworkId)).signature:await t.request({method:"personal_sign",params:[n,r]},g.ChainController.state.activeCaipNetwork?.caipNetworkId)}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){let{caipNetwork:t}=e,n=this.getWalletConnectConnector();if(t.chainNamespace===i.ConstantsUtil.CHAIN.EVM)try{await n.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,J.toHex)(t.id)}]})}catch(e){if(4902===e.code||32603===e.code||5e3===e.code||e?.data?.originalError?.code===4902)try{await n.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:(0,J.toHex)(t.id),rpcUrls:[t?.rpcUrls.chainDefault?.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[t.blockExplorers?.default.url]}]})}catch(e){throw Error("Chain is not supported")}}n.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){let e=this.connectors.find(e=>"WALLET_CONNECT"===e.type);return e?.provider}}let eo=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture","payWithExchange","payments","reownAuthentication","headless"],es={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;let t=e.config;return!!e.isEnabled&&t.includes("email")},processFallback:e=>void 0===e?c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.email:!!e},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;let t=e.config;return!!e.isEnabled&&t.length>0&&t.filter(e=>"email"!==e)},processFallback:e=>void 0===e?c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.socials:"boolean"==typeof e?!!e&&c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.socials:e},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;let t=e.config;return!!e.isEnabled&&t.length>0&&t},processFallback:e=>void 0===e?c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.swaps:"boolean"==typeof e?!!e&&c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.swaps:e},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;let t=e.config;return!!e.isEnabled&&t.length>0&&t},processFallback:e=>void 0===e?c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.onramp:"boolean"==typeof e?!!e&&c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.onramp:e},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>void 0===e?c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.activity:!!e},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>void 0===e?c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.reownBranding:!!e},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>e.isEnabled&&(e.config??[]),processFallback:e=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:()=>c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.multiWallet},payWithExchange:{apiFeatureName:"fund_from_exchange",localFeatureName:"payWithExchange",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:()=>c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.payWithExchange},payments:{apiFeatureName:"payments",localFeatureName:"payments",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:()=>c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.payments},reownAuthentication:{apiFeatureName:"reown_authentication",localFeatureName:"reownAuthentication",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>void 0===e?c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.reownAuthentication:!!e},headless:{apiFeatureName:"headless",localFeatureName:"headless",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:()=>c.ConstantsUtil.DEFAULT_REMOTE_FEATURES.headless}},ea={localSettingsOverridden:new Set,getApiConfig:(e,t)=>t?.find(t=>t.id===e),addWarning(e,t){if(void 0!==e){let e=es[t],n=e.isLegacy?`"features.${e.localFeatureName}" (now "${t}")`:`"features.${t}"`;this.localSettingsOverridden.add(n)}},processFeature(e,t,n,r,i){let o=es[e],s=t[o.localFeatureName];if(i&&!o.isAvailableOnBasic)return!1;if(r){let t=this.getApiConfig(o.apiFeatureName,n);return t?.config===null?this.processFallbackFeature(e,s):!!t?.config&&(void 0!==s&&this.addWarning(s,e),this.processApiFeature(e,t))}return this.processFallbackFeature(e,s)},processApiFeature:(e,t)=>es[e].processApi(t),processFallbackFeature:(e,t)=>es[e].processFallback(t),async fetchRemoteFeatures(e){let t=e.basic??!1,n=e.features||{};this.localSettingsOverridden.clear();let r=null,i=!1;try{i=null!=(r=await s.ApiController.fetchProjectConfig())}catch(e){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",e)}let o=i&&!t?c.ConstantsUtil.DEFAULT_REMOTE_FEATURES:c.ConstantsUtil.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(let e of eo){let s=this.processFeature(e,n,r,i,t);Object.assign(o,{[e]:s})}}catch(e){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",e),c.ConstantsUtil.DEFAULT_REMOTE_FEATURES}if(i&&this.localSettingsOverridden.size>0){let e=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;m.AlertController.open({debugMessage:A.ErrorUtil.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(e)},"warning")}return o}};class el{constructor(e){this.chainNamespaces=[],this.features={},this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(e,t)=>{if(e){let n=g.ChainController.getCaipNetworks(e)?.find(e=>e.id===t);if(n)return n;let r=g.ChainController.getNetworkData(e)?.caipNetwork;if(r)return r;let i=g.ChainController.getRequestedCaipNetworks(e);return i.filter(t=>t.chainNamespace===e)?.[0]}return g.ChainController.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{let e=this.getCaipNetwork();if(e)return e.id},this.getCaipNetworks=e=>g.ChainController.getCaipNetworks(e),this.getActiveChainNamespace=()=>g.ChainController.state.activeChain,this.setRequestedCaipNetworks=(e,t)=>{g.ChainController.setRequestedCaipNetworks(e,t)},this.getApprovedCaipNetworkIds=()=>g.ChainController.getAllApprovedCaipNetworkIds(),this.getCaipAddress=e=>g.ChainController.state.activeChain!==e&&e?g.ChainController.state.chains.get(e)?.accountState?.caipAddress:g.ChainController.state.activeCaipAddress,this.setClientId=e=>{R.BlockchainApiController.setClientId(e)},this.getProvider=e=>w.ProviderController.getProvider(e),this.getProviderType=e=>w.ProviderController.getProviderId(e),this.getPreferredAccountType=e=>(0,p.getPreferredAccountType)(e),this.setCaipAddress=(e,t,n=!1)=>{g.ChainController.setAccountProp("caipAddress",e,t,n),g.ChainController.setAccountProp("address",r.CoreHelperUtil.getPlainAddress(e),t,n)},this.setBalance=(e,t,n)=>{g.ChainController.setAccountProp("balance",e,n),g.ChainController.setAccountProp("balanceSymbol",t,n)},this.setProfileName=(e,t)=>{g.ChainController.setAccountProp("profileName",e,t)},this.setProfileImage=(e,t)=>{g.ChainController.setAccountProp("profileImage",e,t)},this.setUser=(e,t)=>{g.ChainController.setAccountProp("user",e,t)},this.resetAccount=e=>{g.ChainController.resetAccount(e)},this.setCaipNetwork=e=>{g.ChainController.setActiveCaipNetwork(e)},this.setCaipNetworkOfNamespace=(e,t)=>{g.ChainController.setChainNetworkData(t,{caipNetwork:e})},this.setStatus=(e,t)=>{g.ChainController.setAccountProp("status",e,t),l.ConnectorController.isConnected()?v.StorageUtil.setConnectionStatus("connected"):v.StorageUtil.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=e=>g.ChainController.getAccountData(e)?.address,this.setConnectors=e=>{let t=[...l.ConnectorController.state.allConnectors,...e];l.ConnectorController.setConnectors(t)},this.setConnections=(e,t)=>{v.StorageUtil.setConnections(e,t),a.ConnectionController.setConnections(e,t)},this.fetchIdentity=e=>R.BlockchainApiController.fetchIdentity(e),this.getReownName=e=>M.EnsController.getNamesForAddress(e),this.getConnectors=()=>l.ConnectorController.getConnectors(),this.getConnectorImage=e=>_.AssetUtil.getConnectorImage(e),this.getConnections=e=>this.remoteFeatures.multiWallet?L.ConnectionControllerUtil.getConnectionsData(e).connections:(m.AlertController.open(i.ConstantsUtil.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=e=>this.remoteFeatures.multiWallet?L.ConnectionControllerUtil.getConnectionsData(e).recentConnections:(m.AlertController.open(i.ConstantsUtil.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async e=>{this.remoteFeatures.multiWallet?await a.ConnectionController.switchConnection(e):m.AlertController.open(i.ConstantsUtil.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info")},this.deleteConnection=e=>{this.remoteFeatures.multiWallet?(v.StorageUtil.deleteAddressFromConnection(e),a.ConnectionController.syncStorageConnections()):m.AlertController.open(i.ConstantsUtil.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info")},this.setConnectedWalletInfo=(e,t)=>{let n=w.ProviderController.getProviderId(t),r=e?{...e,type:n}:void 0;g.ChainController.setAccountProp("connectedWalletInfo",r,t)},this.getIsConnectedState=()=>!!g.ChainController.state.activeCaipAddress,this.addAddressLabel=(e,t,n)=>{let r=g.ChainController.getAccountData(n)?.addressLabels||{};g.ChainController.setAccountProp("addressLabels",{...r,[e]:t},n)},this.removeAddressLabel=(e,t)=>{let n=g.ChainController.getAccountData(t)?.addressLabels||{};g.ChainController.setAccountProp("addressLabels",{...n,[e]:void 0},t)},this.getAddress=e=>{let t=e||g.ChainController.state.activeChain;return g.ChainController.getAccountData(t)?.address},this.resetNetwork=e=>{g.ChainController.resetNetwork(e)},this.addConnector=e=>{l.ConnectorController.addConnector(e)},this.resetWcConnection=()=>{a.ConnectionController.resetWcConnection()},this.setAddressExplorerUrl=(e,t)=>{g.ChainController.setAccountProp("addressExplorerUrl",e,t)},this.setSmartAccountDeployed=(e,t)=>{g.ChainController.setAccountProp("smartAccountDeployed",e,t)},this.setPreferredAccountType=(e,t)=>{g.ChainController.setAccountProp("preferredAccountType",e,t)},this.setEIP6963Enabled=e=>{f.OptionsController.setEIP6963Enabled(e)},this.handleUnsafeRPCRequest=()=>{this.isOpen()?this.isTransactionStackEmpty()||this.redirect("ApproveTransaction"):this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,t){let n=e?.map(e=>e.namespace).filter(e=>!!e);return n?.length?[...new Set(n)]:[...new Set(t?.map(e=>e.chainNamespace))]}async initialize(t){if(this.initializeProjectSettings(t),this.initControllers(t),await this.initChainAdapters(),this.sendInitializeEvent(t),t.features?.headless&&!W.ConnectorUtil.hasInjectedConnectors()&&s.ApiController.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1,fetchWalletRanks:!1,fetchRecommendedWallets:!0}),f.OptionsController.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),t.basic||t.manualWCControl||(this.remoteFeatures=await ea.fetchRemoteFeatures(t)),await s.ApiController.fetchUsage(),f.OptionsController.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&D.OnRampController.setOnrampProviders(this.remoteFeatures.onramp),(f.OptionsController.state.remoteFeatures?.email||Array.isArray(f.OptionsController.state.remoteFeatures?.socials)&&f.OptionsController.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins(),f.OptionsController.state.features?.reownAuthentication||f.OptionsController.state.remoteFeatures?.reownAuthentication){let{ReownAuthentication:t}=await e.A(731507),n=f.OptionsController.state.siwx;n instanceof t||(n&&console.warn("ReownAuthentication option is enabled, SIWX configuration will be overridden."),f.OptionsController.setSIWX(new t))}}async openSend(e){let t=e.namespace||g.ChainController.state.activeChain,n=this.getCaipAddress(t),r=this.getCaipNetwork(t)?.id;if(!n)throw Error("openSend: caipAddress not found");if(r?.toString()!==e.chainId.toString()){let n=g.ChainController.getCaipNetworkById(e.chainId,t);if(!n)throw Error(`openSend: caipNetwork with chainId ${e.chainId} not found`);await this.switchNetwork(n,{throwOnFailure:!0})}try{let t=X.getTokenSymbolByAddress(e.assetAddress);t&&await s.ApiController.fetchTokenImages([t])}catch{}return await F.ModalController.open({view:"WalletSend",data:{send:e}}),new Promise((e,t)=>{let n=x.SendController.subscribeKey("hash",t=>{t&&(i(),e({hash:t}))}),r=F.ModalController.subscribe(e=>{e.open||(i(),t(Error("Modal closed")))}),i=this.createCleanupHandler([n,r])})}toModalOptions(){return{isSwap:function(e){return e?.view==="Swap"},isSend:function(e){return e?.view==="WalletSend"}}}async checkAllowedOrigins(){try{let e=await s.ApiController.fetchAllowedOrigins();if(!r.CoreHelperUtil.isClient())return;let t=window.location.origin;K.isOriginAllowed(t,e,i.ConstantsUtil.DEFAULT_ALLOWED_ANCESTORS)||m.AlertController.open(A.ErrorUtil.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error))return;switch(e.message){case"RATE_LIMITED":m.AlertController.open(A.ErrorUtil.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{let t=e.cause instanceof Error?e.cause:e;m.AlertController.open({displayMessage:A.ErrorUtil.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:A.ErrorUtil.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(t.message)},"error")}}}}createCleanupHandler(e){return()=>{e.forEach(e=>{try{e()}catch{}})}}sendInitializeEvent(e){let{...t}=e;delete t.adapters,delete t.universalProvider,d.EventsController.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map(e=>e.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initAdapterController(){k.AdapterController.initialize(this.chainAdapters)}initializeThemeController(e){e.themeMode&&E.ThemeController.setThemeMode(e.themeMode),e.themeVariables&&E.ThemeController.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient)throw Error("ConnectionControllerClient must be set");g.ChainController.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient});let t=this.getDefaultNetwork();t&&g.ChainController.setActiveCaipNetwork(t)}initializeConnectionController(e){a.ConnectionController.initialize(e.adapters??[]),a.ConnectionController.setWcBasic(e.basic??!1)}initializeConnectorController(){l.ConnectorController.initialize(this.chainNamespaces)}initializeProjectSettings(e){f.OptionsController.setProjectId(e.projectId),f.OptionsController.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){f.OptionsController.setDebug(!1!==e.debug),f.OptionsController.setEnableWalletGuide(!1!==e.enableWalletGuide),f.OptionsController.setEnableWallets(!1!==e.enableWallets),f.OptionsController.setEIP6963Enabled(!1!==e.enableEIP6963),f.OptionsController.setEnableNetworkSwitch(!1!==e.enableNetworkSwitch),f.OptionsController.setEnableReconnect(!1!==e.enableReconnect),f.OptionsController.setEnableMobileFullScreen(!0===e.enableMobileFullScreen),f.OptionsController.setCoinbasePreference(e.coinbasePreference),f.OptionsController.setEnableAuthLogger(!1!==e.enableAuthLogger),f.OptionsController.setCustomRpcUrls(e.customRpcUrls),f.OptionsController.setEnableEmbedded(e.enableEmbedded),f.OptionsController.setAllWallets(e.allWallets),f.OptionsController.setIncludeWalletIds(e.includeWalletIds),f.OptionsController.setExcludeWalletIds(e.excludeWalletIds),f.OptionsController.setFeaturedWalletIds(e.featuredWalletIds),f.OptionsController.setTokens(e.tokens),f.OptionsController.setTermsConditionsUrl(e.termsConditionsUrl),f.OptionsController.setPrivacyPolicyUrl(e.privacyPolicyUrl),f.OptionsController.setCustomWallets(e.customWallets),f.OptionsController.setFeatures(e.features),f.OptionsController.setAllowUnsupportedChain(e.allowUnsupportedChain),f.OptionsController.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),f.OptionsController.setPreferUniversalLinks(e.experimental_preferUniversalLinks),f.OptionsController.setDefaultAccountTypes(e.defaultAccountTypes);let t=this.getDefaultMetaData();if(!e.metadata&&t&&(e.metadata=t),f.OptionsController.setMetadata(e.metadata),f.OptionsController.setDisableAppend(e.disableAppend),f.OptionsController.setEnableEmbedded(e.enableEmbedded),f.OptionsController.setSIWX(e.siwx),this.features=f.OptionsController.state.features??{},!e.projectId)return void m.AlertController.open(A.ErrorUtil.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");if(e.adapters?.find(e=>e.namespace===i.ConstantsUtil.CHAIN.EVM)&&e.siweConfig){if(e.siwx)throw Error("Cannot set both `siweConfig` and `siwx` options");f.OptionsController.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return r.CoreHelperUtil.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){let t=this.getActiveChainNamespace();if(t){let n=V.CaipNetworksUtil.getUnsupportedNetwork(`${t}:${e}`);g.ChainController.setActiveCaipNetwork(n)}}getDefaultNetwork(){return V.CaipNetworksUtil.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return V.CaipNetworksUtil.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return V.CaipNetworksUtil.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){let t=e.networks.find(t=>t.id===e.defaultNetwork?.id);return t?V.CaipNetworksUtil.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectConnector(e,t){try{this.setLoading(!0,e);let n={connections:[]},r=this.getAdapter(e);return(g.ChainController.state.chains.get(e)?.accountState?.caipAddress||!f.OptionsController.state.enableReconnect)&&r?.disconnect&&(n=await r.disconnect({id:t})),this.setLoading(!1,e),n}catch(t){throw this.setLoading(!1,e),Error(`Failed to disconnect chains: ${t.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{let e=g.ChainController.state.activeChain,t=this.getAdapter(e),n=this.getCaipNetwork(e)?.id,r=a.ConnectionController.getConnections(e),i=this.remoteFeatures.multiWallet,o=r.length>0;if(!t)throw Error("Adapter not found");let s=await t.connectWalletConnect(n);o&&i||this.close(),this.setClientId(s?.clientId||null),v.StorageUtil.setConnectedNamespaces([...g.ChainController.state.chains.keys()]),await this.syncWalletConnectAccount(),await C.SIWXUtil.initializeIfEnabled()},connectExternal:async e=>{let t=await this.onConnectExternal(e);return await this.connectInactiveNamespaces(e,t),t?{address:t.address}:void 0},reconnectExternal:async({id:e,info:t,type:n,provider:r})=>{let i=g.ChainController.state.activeChain,o=this.getAdapter(i);if(!i)throw Error("reconnectExternal: namespace not found");if(!o)throw Error("reconnectExternal: adapter not found");o?.reconnect&&(await o?.reconnect({id:e,info:t,type:n,provider:r,chainId:this.getCaipNetwork()?.id}),v.StorageUtil.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnectConnector:async e=>{await this.disconnectConnector(e.namespace,e.id)},disconnect:async e=>{let{id:t,chainNamespace:n,initialDisconnect:r}=e||{},o=n||g.ChainController.state.activeChain,s=l.ConnectorController.getConnectorId(o),c=t===i.ConstantsUtil.CONNECTOR_ID.AUTH||s===i.ConstantsUtil.CONNECTOR_ID.AUTH,u=t===i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT||s===i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT;try{let e=Array.from(g.ChainController.state.chains.keys()),i=n?[n]:e;(u||c)&&(i=e);let o=i.map(async e=>{let n=l.ConnectorController.getConnectorId(e),i=await this.disconnectConnector(e,t||n);i&&(c&&v.StorageUtil.deleteConnectedSocialProvider(),i.connections.forEach(t=>{v.StorageUtil.addDisconnectedConnectorId(t.connectorId,e)})),r&&this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}),s=await Promise.allSettled(o);x.SendController.resetSend(),a.ConnectionController.resetWcConnection(),C.SIWXUtil.getSIWX()?.signOutOnDisconnect&&await C.SIWXUtil.clearSessions(),l.ConnectorController.setFilterByNamespace(void 0),a.ConnectionController.syncStorageConnections();let h=s.filter(e=>"rejected"===e.status);if(h.length>0)throw Error(h.map(e=>e.reason.message).join(", "));d.EventsController.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:n||"all"}})}catch(e){throw Error(`Failed to disconnect chains: ${e.message}`)}},checkInstalled:e=>e?e.some(e=>!!window.ethereum?.[String(e)]):!!window.ethereum,signMessage:async e=>{let t=g.ChainController.state.activeChain,n=this.getAdapter(g.ChainController.state.activeChain);if(!t)throw Error("signMessage: namespace not found");if(!n)throw Error("signMessage: adapter not found");let r=this.getAddress(t);if(!r)throw Error("signMessage: address not found");let i=await n?.signMessage({message:e,address:r,provider:w.ProviderController.getProvider(t)});return i?.signature||""},sendTransaction:async e=>{let t=e.chainNamespace;if(!t)throw Error("sendTransaction: namespace not found");if(c.ConstantsUtil.SEND_SUPPORTED_NAMESPACES.includes(t)){let n=this.getAdapter(t);if(!n)throw Error("sendTransaction: adapter not found");let r=w.ProviderController.getProvider(t),i=await n?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:r});return i?.hash||""}return""},estimateGas:async e=>{let t=e.chainNamespace;if(t===i.ConstantsUtil.CHAIN.EVM){let n=this.getAdapter(t);if(!n)throw Error("estimateGas: adapter is required but got undefined");let r=w.ProviderController.getProvider(t),i=this.getCaipNetwork();if(!i)throw Error("estimateGas: caipNetwork is required but got undefined");let o=await n?.estimateGas({...e,provider:r,caipNetwork:i});return o?.gas||0n}return 0n},getEnsAvatar:async()=>{let e=g.ChainController.state.activeChain;if(!e)throw Error("getEnsAvatar: namespace is required but got undefined");let t=this.getAddress(e);if(!t)throw Error("getEnsAvatar: address not found");await this.syncIdentity({address:t,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:e});let n=g.ChainController.getAccountData();return n?.profileImage||!1},getEnsAddress:async e=>await K.resolveReownName(e),writeContract:async e=>{let t=g.ChainController.state.activeChain,n=this.getAdapter(t);if(!t)throw Error("writeContract: namespace is required but got undefined");if(!n)throw Error("writeContract: adapter is required but got undefined");let r=this.getCaipNetwork(),i=this.getCaipAddress(),o=w.ProviderController.getProvider(t);if(!r||!i)throw Error("writeContract: caipNetwork or caipAddress is required but got undefined");let s=await n?.writeContract({...e,caipNetwork:r,provider:o,caipAddress:i});return s?.hash},writeSolanaTransaction:async e=>{let t=g.ChainController.state.activeChain,n=this.getAdapter(t);if(!t)throw Error("writeContract: namespace is required but got undefined");if(!n)throw Error("writeContract: adapter is required but got undefined");let r=this.getCaipNetwork(),i=this.getCaipAddress(),o=w.ProviderController.getProvider(t);if(!r||!i)throw Error("writeContract: caipNetwork or caipAddress is required but got undefined");let s=await n?.writeSolanaTransaction({...e,caipNetwork:r,provider:o,caipAddress:i});return s?.hash},parseUnits:(e,t)=>{let n=this.getAdapter(g.ChainController.state.activeChain);if(!n)throw Error("parseUnits: adapter is required but got undefined");return n?.parseUnits({value:e,decimals:t})??0n},formatUnits:(e,t)=>{let n=this.getAdapter(g.ChainController.state.activeChain);if(!n)throw Error("formatUnits: adapter is required but got undefined");return n?.formatUnits({value:e,decimals:t})??"0"},getCapabilities:async e=>{let t=this.getAdapter(g.ChainController.state.activeChain);if(!t)throw Error("getCapabilities: adapter is required but got undefined");return await t?.getCapabilities(e)},grantPermissions:async e=>{let t=this.getAdapter(g.ChainController.state.activeChain);if(!t)throw Error("grantPermissions: adapter is required but got undefined");return await t?.grantPermissions(e)},revokePermissions:async e=>{let t=this.getAdapter(g.ChainController.state.activeChain);if(!t)throw Error("revokePermissions: adapter is required but got undefined");return t?.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{let t=this.getAdapter(g.ChainController.state.activeChain);if(!t)throw Error("walletGetAssets: adapter is required but got undefined");return await t?.walletGetAssets(e)??{}},updateBalance:e=>{let t=this.getAddress(e),n=this.getCaipNetwork(e);n&&t&&this.updateNativeBalance(t,n?.id,e)}},a.ConnectionController.setClient(this.connectionControllerClient)}async onConnectExternal(e){let t=g.ChainController.state.activeChain,n=e.chain||t,r=this.getAdapter(n),o=!0;if(e.type===y.ConstantsUtil.CONNECTOR_TYPE_AUTH&&i.ConstantsUtil.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(e=>l.ConnectorController.getConnectorId(e)===i.ConstantsUtil.CONNECTOR_ID.AUTH)&&e.chain!==t&&(o=!1),e.chain&&e.chain!==t&&!e.caipNetwork){let t=this.getCaipNetworks().find(t=>t.chainNamespace===e.chain);t&&o&&this.setCaipNetwork(t)}if(!n)throw Error("connectExternal: namespace not found");if(!r)throw Error("connectExternal: adapter not found");let s=this.getCaipNetwork(n),a=e.caipNetwork||s,c=await r.connect({id:e.id,address:e.address,info:e.info,type:e.type,provider:e.provider,socialUri:e.socialUri,chainId:e.caipNetwork?.id||s?.id,rpcUrl:e.caipNetwork?.rpcUrls?.default?.http?.[0]||s?.rpcUrls?.default?.http?.[0]});if(c)return v.StorageUtil.addConnectedNamespace(n),this.syncProvider({...c,chainNamespace:n}),this.setStatus("connected",n),this.syncConnectedWalletInfo(n),v.StorageUtil.removeDisconnectedConnectorId(e.id,n),{address:c.address,connectedCaipNetwork:a}}async connectInactiveNamespaces(e,t){let n=e.type===y.ConstantsUtil.CONNECTOR_TYPE_AUTH,r=N.HelpersUtil.getOtherAuthNamespaces(t?.connectedCaipNetwork?.chainNamespace),i=g.ChainController.state.activeCaipNetwork,o=this.getAdapter(i?.chainNamespace);n&&(await Promise.all(r.map(async t=>{try{let n=w.ProviderController.getProvider(t),r=this.getCaipNetwork(t),i=this.getAdapter(t);await i?.connect({...e,provider:n,socialUri:void 0,chainId:r?.id,rpcUrl:r?.rpcUrls?.default?.http?.[0]})&&(v.StorageUtil.addConnectedNamespace(t),v.StorageUtil.removeDisconnectedConnectorId(e.id,t),this.setStatus("connected",t),this.syncConnectedWalletInfo(t))}catch(e){m.AlertController.warn(A.ErrorUtil.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.displayMessage,A.ErrorUtil.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.debugMessage(t,e instanceof Error?e.message:void 0),A.ErrorUtil.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.code)}})),i&&await o?.switchNetwork({caipNetwork:i}))}getApprovedCaipNetworksData(){if(w.ProviderController.getProviderId(g.ChainController.state.activeChain)===y.ConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT){let e=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(e)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){let t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){let n=w.ProviderController.getProviderId(t);if(e.chainNamespace===g.ChainController.state.activeChain){let n=this.getAdapter(t);await n?.switchNetwork({caipNetwork:e})}else if(this.setCaipNetwork(e),n===y.ConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{let n=this.getAddressByChainNamespace(t);n&&this.syncAccount({address:n,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(e=>Array.from(new Set([...e.chains||[],...e.accounts.map(e=>{let{chainId:t,chainNamespace:n}=P.ParseUtil.parseCaipAddress(e);return`${n}:${t}`})])))}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,n)=>{let r=e?.find(e=>e.namespace===n);return r?(r.construct({namespace:n,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:e})=>e===n)}),t[n]=r):t[n]=new ei({namespace:n,networks:this.getCaipNetworks()}),t},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e);let t=this.getAdapter(e);if(!t)throw Error("adapter not found");await t.syncConnectors(),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)})),this.initAdapterController()}onConnectors(e){let t=this.getAdapter(e);t?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){let t=this.getAdapter(e);if(!t)return;let n=v.StorageUtil.getConnectionStatus();!1===f.OptionsController.state.enableReconnect?this.setStatus("disconnected",e):"connected"===n?this.setStatus("connecting",e):("disconnected"===n&&v.StorageUtil.clearAddressCache(),this.setStatus(n,e)),t.on("switchNetwork",({address:t,chainId:n})=>{let r=this.getCaipNetworks().find(e=>e.id.toString()===n.toString()||e.caipNetworkId.toString()===n.toString()),i=g.ChainController.state.activeChain===e,o=g.ChainController.state.chains.get(e)?.accountState?.address;if(r){let n=i&&t?t:o;n&&this.syncAccount({address:n,chainId:r.id,chainNamespace:e})}else this.setUnsupportedNetwork(n)}),t.on("disconnect",()=>{let t=this.remoteFeatures.multiWallet,n=Array.from(a.ConnectionController.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!t||0===n.length})}),t.on("connections",t=>{this.setConnections(t,e)}),t.on("pendingTransactions",()=>{let t=this.getAddress(e),n=g.ChainController.state.activeCaipNetwork;t&&n?.id&&this.updateNativeBalance(t,n.id,n.chainNamespace)}),t.on("accountChanged",({address:t,chainId:n,connector:r})=>{this.handlePreviousConnectorConnection(r);let i=g.ChainController.state.activeChain===e;r?.provider&&(this.syncProvider({id:r.id,type:r.type,provider:r?.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e));let o=g.ChainController.getNetworkData(e)?.caipNetwork?.id,s=n||o;i&&s?this.syncAccount({address:t,chainId:s,chainNamespace:e}):!i&&s?(this.syncAccountInfo(t,s,e),this.syncBalance({address:t,chainId:s,chainNamespace:e})):this.syncAccountInfo(t,n,e),v.StorageUtil.addConnectedNamespace(e)})}async handlePreviousConnectorConnection(e){let t=e?.chain,n=e?.id,r=l.ConnectorController.getConnectorId(t),i=f.OptionsController.state.remoteFeatures?.multiWallet,o=r!==n,s=t&&n&&r&&o&&!i;try{s&&await a.ConnectionController.disconnect({id:r,namespace:t})}catch(e){console.warn("Error disconnecting previous connector",e)}}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&await this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>a.ConnectionController.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async reconnectWalletConnect(){await this.syncWalletConnectAccount();let e=this.getAddress();this.getCaipAddress()||v.StorageUtil.deleteRecentWallet();let t=v.StorageUtil.getRecentWallet();d.EventsController.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:r.CoreHelperUtil.isMobile()?"mobile":"qrcode",name:t?.name||"Unknown",reconnect:!0,view:h.RouterController.state.view,walletRank:t?.order}})}async syncNamespaceConnection(e){try{e===i.ConstantsUtil.CHAIN.EVM&&r.CoreHelperUtil.isSafeApp()&&l.ConnectorController.setConnectorId(i.ConstantsUtil.CONNECTOR_ID.SAFE,e);let t=l.ConnectorController.getConnectorId(e);switch(this.setStatus("connecting",e),t){case i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT:await this.reconnectWalletConnect();break;case i.ConstantsUtil.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){let{chainNamespace:t,closeModal:n}=e||{};g.ChainController.resetAccount(t),g.ChainController.resetNetwork(t),v.StorageUtil.removeConnectedNamespace(t);let r=Array.from(g.ChainController.state.chains.keys());(t?[t]:r).forEach(e=>v.StorageUtil.addDisconnectedConnectorId(l.ConnectorController.getConnectorId(e)||"",e)),l.ConnectorController.removeConnectorId(t),w.ProviderController.resetChain(t),this.setUser(null,t),this.setStatus("disconnected",t),this.setConnectedWalletInfo(null,t),!1!==n&&F.ModalController.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{let t=this.getAdapter(e),n=this.getCaipAddress(e),r=this.getCaipNetwork(e);return t?.syncConnections({connectToFirstConnector:!n,caipNetwork:r})}))}async syncAdapterConnection(e){let t=this.getAdapter(e),n=this.getCaipNetwork(e),r=l.ConnectorController.getConnectorId(e),i=l.ConnectorController.getConnectors(e).find(e=>e.id===r);try{if(!t||!i)throw Error(`Adapter or connector not found for namespace ${e}`);if(!n?.id)throw Error("CaipNetwork not found");let r=await t?.syncConnection({namespace:e,id:i.id,chainId:n.id,rpcUrl:n?.rpcUrls?.default?.http?.[0]});r?(this.syncProvider({...r,chainNamespace:e}),await this.syncAccount({...r,chainNamespace:e}),this.setStatus("connected",e),d.EventsController.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:r.address,properties:{method:"browser",name:i.info?.name||i.name||"Unknown",reconnect:!0,view:h.RouterController.state.view,walletRank:i?.explorerWallet?.order}})):this.setStatus("disconnected",e)}catch(t){this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){let e=Object.keys(this.universalProvider?.session?.namespaces||{}),t=this.chainNamespaces.map(async t=>{let n=this.getAdapter(t);if(!n)return;let r=this.universalProvider?.session?.namespaces?.[t]?.accounts||[],o=g.ChainController.state.activeCaipNetwork?.id,s=r.find(e=>{let{chainId:t}=P.ParseUtil.parseCaipAddress(e);return t===o?.toString()})||r[0];if(s){let e=P.ParseUtil.validateCaipAddress(s),{chainId:r,address:o}=P.ParseUtil.parseCaipAddress(e);if(w.ProviderController.setProviderId(t,y.ConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&g.ChainController.state.activeCaipNetwork&&n.namespace!==i.ConstantsUtil.CHAIN.EVM){let e=n.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:g.ChainController.state.activeCaipNetwork});w.ProviderController.setProvider(t,e)}else w.ProviderController.setProvider(t,this.universalProvider);l.ConnectorController.setConnectorId(i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT,t),v.StorageUtil.addConnectedNamespace(t),await this.syncAccount({address:o,chainId:r,chainNamespace:t})}else e.includes(t)&&this.setStatus("disconnected",t);let a=this.getApprovedCaipNetworksData();this.syncConnectedWalletInfo(t),g.ChainController.setApprovedCaipNetworksData(t,{approvedCaipNetworkIds:a.approvedCaipNetworkIds,supportsAllNetworks:a.supportsAllNetworks})});await Promise.all(t)}syncProvider({type:e,provider:t,id:n,chainNamespace:r}){w.ProviderController.setProviderId(r,e),w.ProviderController.setProvider(r,t),l.ConnectorController.setConnectorId(n,r)}async syncAccount(e){let t=e.chainNamespace===g.ChainController.state.activeChain,n=g.ChainController.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:r,chainId:o,chainNamespace:s}=e,{chainId:a}=v.StorageUtil.getActiveNetworkProps(),l=n?.id||a,c=g.ChainController.state.activeCaipNetwork?.name===i.ConstantsUtil.UNSUPPORTED_NETWORK_NAME,d=g.ChainController.getNetworkProp("supportsAllNetworks",s);if(this.setStatus("connected",s),(!c||d)&&l){let e=this.getCaipNetworks().find(e=>e.id.toString()===l.toString()),a=this.getCaipNetworks().find(e=>e.chainNamespace===s);if(!d&&!e&&!a){let t=this.getApprovedCaipNetworkIds()||[],n=t.find(e=>P.ParseUtil.parseCaipNetworkId(e)?.chainId===l.toString()),r=t.find(e=>P.ParseUtil.parseCaipNetworkId(e)?.chainNamespace===s);e=this.getCaipNetworks().find(e=>e.caipNetworkId===n),a=this.getCaipNetworks().find(e=>e.caipNetworkId===r||"deprecatedCaipNetworkId"in e&&e.deprecatedCaipNetworkId===r)}let c=e||a;c?.chainNamespace===g.ChainController.state.activeChain?f.OptionsController.state.enableNetworkSwitch&&!f.OptionsController.state.allowUnsupportedChain&&g.ChainController.state.activeCaipNetwork?.name===i.ConstantsUtil.UNSUPPORTED_NETWORK_NAME?g.ChainController.showUnsupportedChainUI():this.setCaipNetwork(c):!t&&n&&this.setCaipNetworkOfNamespace(n,s),this.syncConnectedWalletInfo(s);let u=this.getAddress(s);N.HelpersUtil.isLowerCaseMatch(r,u)||this.syncAccountInfo(r,c?.id,s),t?await this.syncBalance({address:r,chainId:c?.id,chainNamespace:s}):await this.syncBalance({address:r,chainId:n?.id,chainNamespace:s}),this.syncIdentity({address:r,chainId:o,chainNamespace:s})}}async syncAccountInfo(e,t,n){let r=this.getCaipAddress(n),i=t||r?.split(":")[1];if(!i)return;let o=`${n}:${i}:${e}`;this.setCaipAddress(o,n,!0),await this.syncIdentity({address:e,chainId:i,chainNamespace:n})}async syncReownName(e,t){try{let n=await this.getReownName(e);if(n[0]){let e=n[0];this.setProfileName(e.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){let t=l.ConnectorController.getConnectorId(e),n=w.ProviderController.getProviderId(e);if(n===y.ConstantsUtil.CONNECTOR_TYPE_ANNOUNCED||n===y.ConstantsUtil.CONNECTOR_TYPE_INJECTED){if(t){let n=this.getConnectors().find(e=>{let n=e.id===t,r=e.info?.rdns===t,i=e.connectors?.some(e=>e.id===t||e.info?.rdns===t);return n||r||!!i});if(n){let{info:t,name:r,imageUrl:i}=n,o=i||this.getConnectorImage(n);this.setConnectedWalletInfo({name:r,icon:o,...t},e)}}}else if(n===y.ConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT){let t=w.ProviderController.getProvider(e);t?.session&&this.setConnectedWalletInfo({...t.session.peer.metadata,name:t.session.peer.metadata.name,icon:t.session.peer.metadata.icons?.[0]},e)}else if(t&&(t===i.ConstantsUtil.CONNECTOR_ID.COINBASE_SDK||t===i.ConstantsUtil.CONNECTOR_ID.COINBASE)){let n=this.getConnectors().find(e=>e.id===t),r=n?.name||"Coinbase Wallet",i=n?.imageUrl||this.getConnectorImage(n),o=n?.info;this.setConnectedWalletInfo({...o,name:r,icon:i},e)}}async syncBalance(e){S.NetworkUtil.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(t=>t.id.toString()===e.chainId?.toString())&&e.chainId&&await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,t,n){let r=this.getAdapter(n),i=g.ChainController.getCaipNetworkByNamespace(n,t);if(r){let o=await r.getBalance({address:e,chainId:t,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,n),o}}async initializeUniversalAdapter(){let e=G.createLogger((e,...t)=>{e&&this.handleAlertError(e),console.error(...t)}),t={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};f.OptionsController.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await O.default.init(t);let n=this.universalProvider.disconnect.bind(this.universalProvider);this.universalProvider.disconnect=async()=>{try{return await n()}catch(e){if(e instanceof Error&&e.message.includes("Missing or invalid. Record was recently deleted"))return;throw e}},!1===f.OptionsController.state.enableReconnect&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{K.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:e=>{a.ConnectionController.setUri(e)},onConnect:e=>{let{address:t}=r.CoreHelperUtil.getAccount(e[0]);for(let e of this.chainNamespaces)v.StorageUtil.removeDisconnectedConnectorId(i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT,e);a.ConnectionController.finalizeWcConnection(t)},onDisconnect:()=>{g.ChainController.state.noAdapters&&this.resetAccount(e),a.ConnectionController.resetWcConnection()},onChainChanged:t=>{let n=g.ChainController.state.activeChain,r=n&&l.ConnectorController.state.activeConnectorIds[n]===i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT;if(n===e&&(g.ChainController.state.noAdapters||r)){let e=this.getCaipNetworks().find(e=>e.id.toString()===t.toString()||e.caipNetworkId.toString()===t.toString()),n=this.getCaipNetwork();if(!e)return void this.setUnsupportedNetwork(t);n?.id.toString()!==e?.id.toString()&&n?.chainNamespace===e?.chainNamespace&&this.setCaipNetwork(e)}},onAccountsChanged:t=>{let n=g.ChainController.state.activeChain,r=n&&l.ConnectorController.state.activeConnectorIds[n]===i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT;if(n===e&&(g.ChainController.state.noAdapters||r)){let e=t?.[0];e&&this.syncAccount({address:e.address,chainId:e.chainId,chainNamespace:e.chainNamespace})}}})})}createUniversalProvider(){return!this.universalProviderInitPromise&&r.CoreHelperUtil.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){d.EventsController.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}getDisabledCaipNetworks(){let e=g.ChainController.getAllApprovedCaipNetworkIds(),t=g.ChainController.getAllRequestedCaipNetworks();return r.CoreHelperUtil.sortRequestedNetworks(e,t).filter(e=>g.ChainController.isCaipNetworkDisabled(e))}handleAlertError(e){let[t,n]=Object.entries(A.ErrorUtil.UniversalProviderErrors).find(([,{message:t}])=>e.message.includes(t))??[],{message:r,alertErrorKey:i}=n??{};if(t&&r&&!this.reportedAlertErrors[t]){let e=A.ErrorUtil.ALERT_ERRORS[i];e&&(m.AlertController.open(e,"error"),this.reportedAlertErrors[t]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;let t=e.namespace;t&&(this.createClients(),e.namespace=t,e.construct({namespace:t,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:e})=>e===t)}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=e))}async open(e){await this.injectModalUi(),e?.uri&&a.ConnectionController.setUri(e.uri);let{isSwap:t,isSend:n}=this.toModalOptions();return t(e)?F.ModalController.open({...e,data:{swap:e.arguments}}):n(e)&&e.arguments?this.openSend(e.arguments):F.ModalController.open(e)}async close(){await this.injectModalUi(),F.ModalController.close()}setLoading(e,t){F.ModalController.setLoading(e,t)}async disconnect(e){await a.ConnectionController.disconnect({namespace:e})}getSIWX(){return f.OptionsController.state.siwx}getError(){return""}getChainId(){return g.ChainController.state.activeCaipNetwork?.id}async switchNetwork(e,{throwOnFailure:t=!1}={}){let n=this.getCaipNetworks().find(t=>t.id===e.id);n?await g.ChainController.switchActiveNetwork(n,{throwOnFailure:t}):m.AlertController.open(A.ErrorUtil.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error")}getWalletProvider(){return g.ChainController.state.activeChain?w.ProviderController.state.providers[g.ChainController.state.activeChain]:null}getWalletProviderType(){return w.ProviderController.getProviderId(g.ChainController.state.activeChain)}subscribeProviders(e){return w.ProviderController.subscribeProviders(e)}getThemeMode(){return E.ThemeController.state.themeMode}getThemeVariables(){return E.ThemeController.state.themeVariables}setThemeMode(e){E.ThemeController.setThemeMode(e),(0,$.setColorTheme)(E.ThemeController.state.themeMode)}setTermsConditionsUrl(e){f.OptionsController.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){f.OptionsController.setPrivacyPolicyUrl(e)}setThemeVariables(e){E.ThemeController.setThemeVariables(e),(0,$.setThemeVariables)(E.ThemeController.state.themeVariables)}subscribeTheme(e){return E.ThemeController.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?a.ConnectionController.subscribe(e):(m.AlertController.open(i.ConstantsUtil.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>void 0)}getWalletInfo(e){if(e)return g.ChainController.state.chains.get(e)?.accountState?.connectedWalletInfo;let t=g.ChainController.getAccountData();return t?.connectedWalletInfo}getAccount(e){let t=e||g.ChainController.state.activeChain,n=l.ConnectorController.getAuthConnector(t),o=g.ChainController.getAccountData(t),s=v.StorageUtil.getConnectedConnectorId(g.ChainController.state.activeChain),c=a.ConnectionController.getConnections(t);if(!t)throw Error("AppKit:getAccount - namespace is required");let d=c.flatMap(e=>e.accounts.map(({address:e,type:n,publicKey:i})=>r.CoreHelperUtil.createAccount(t,e,n||"eoa",i)));if(o)return{allAccounts:d,caipAddress:o.caipAddress,address:r.CoreHelperUtil.getPlainAddress(o.caipAddress),isConnected:!!o.caipAddress,status:o.status,embeddedWalletInfo:n&&s===i.ConstantsUtil.CONNECTOR_ID.AUTH?{user:o.user?{...o.user,username:v.StorageUtil.getConnectedSocialUsername()}:void 0,authProvider:o.socialProvider||"email",accountType:(0,p.getPreferredAccountType)(t),isSmartAccountDeployed:!!o.smartAccountDeployed}:void 0}}subscribeAccount(e,t){let n=[],r=()=>{let n=this.getAccount(t);n&&e(n)};if(t){let e=g.ChainController.subscribeChainProp("accountState",r,t);n.push(e)}else{let e=g.ChainController.subscribe(r);n.push(e)}let i=l.ConnectorController.subscribe(r);return n.push(i),()=>{n.forEach(e=>e())}}subscribeNetwork(e){return g.ChainController.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t?.id,caipNetworkId:t?.caipNetworkId})})}subscribeWalletInfo(e,t){return t?g.ChainController.subscribeChainProp("accountState",t=>e(t?.connectedWalletInfo),t):g.ChainController.subscribeChainProp("accountState",t=>e(t?.connectedWalletInfo))}subscribeShouldUpdateToAddress(e){return g.ChainController.subscribeChainProp("accountState",t=>e(t?.shouldUpdateToAddress))}subscribeCaipNetworkChange(e){return g.ChainController.subscribeKey("activeCaipNetwork",e)}getState(){return u.PublicStateController.state}getRemoteFeatures(){return f.OptionsController.state.remoteFeatures}subscribeState(e){return u.PublicStateController.subscribe(e)}subscribeRemoteFeatures(e){return f.OptionsController.subscribeKey("remoteFeatures",e)}showErrorMessage(e){j.SnackController.showError(e)}showSuccessMessage(e){j.SnackController.showSuccess(e)}getEvent(){return{...d.EventsController.state}}subscribeEvents(e){return d.EventsController.subscribe(e)}replace(e){h.RouterController.replace(e)}redirect(e){h.RouterController.push(e)}popTransactionStack(e){h.RouterController.popTransactionStack(e)}isOpen(){return F.ModalController.state.open}isTransactionStackEmpty(){return 0===h.RouterController.state.transactionStack.length}static getInstance(){return this.instance}updateFeatures(e){f.OptionsController.setFeatures(e)}updateRemoteFeatures(e){f.OptionsController.setRemoteFeatures(e)}updateOptions(e){let t={...f.OptionsController.state||{},...e};f.OptionsController.setOptions(t)}setConnectMethodsOrder(e){f.OptionsController.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){f.OptionsController.setWalletFeaturesOrder(e)}setCollapseWallets(e){f.OptionsController.setCollapseWallets(e)}setSocialsOrder(e){f.OptionsController.setSocialsOrder(e)}getConnectMethodsOrder(){return H.WalletUtil.getConnectOrderMethod(f.OptionsController.state.features,l.ConnectorController.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw Error(`Adapter for namespace ${e} doesn't exist`);let n=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find(e=>e.id===n.id)||g.ChainController.addNetwork(n)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(e=>e.id===t)&&g.ChainController.removeNetwork(e,t)}}let ec=!1;class ed extends el{async onAuthProviderConnected(e){let t=N.HelpersUtil.userChainIdToChainNamespace(e?.chainId);if(e.message&&e.signature&&e.siwxMessage&&await C.SIWXUtil.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature),!t)throw Error("AppKit:onAuthProviderConnected - namespace is required");let n=t===i.ConstantsUtil.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,r=f.OptionsController.state.defaultAccountTypes[t],o=(0,p.getPreferredAccountType)(t),s=e.preferredAccountType||o||r;this.setCaipAddress(n,t);let{signature:a,siwxMessage:l,message:c,...d}=e,u=g.ChainController.getAccountData(t);this.setUser({...u?.user||{},...d},t),this.setSmartAccountDeployed(!!e.smartAccountDeployed,t),this.setPreferredAccountType(s,t),await Promise.all([this.syncAuthConnectorTheme(this.authProvider),this.syncAccount({address:e.address,chainId:e.chainId,chainNamespace:t})]),this.setLoading(!1,t)}setupAuthConnectorListeners(e){e.onRpcRequest(t=>{T.W3mFrameHelpers.checkIfRequestExists(t)?T.W3mFrameHelpers.checkIfRequestIsSafe(t)||this.handleUnsafeRPCRequest():(this.open(),console.error(b.W3mFrameRpcConstants.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:t.method}),setTimeout(()=>{this.showErrorMessage(b.W3mFrameRpcConstants.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((e,t)=>{let n=T.W3mFrameHelpers.checkIfRequestIsSafe(t),r=this.getAddress(),i=g.ChainController.state.activeCaipNetwork;n||(r&&i?.id&&this.updateNativeBalance(r,i.id,i.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{let e=g.ChainController.state.activeChain;if(!e)throw Error("AppKit:onNotConnected - namespace is required");l.ConnectorController.getConnectorId(e)===i.ConstantsUtil.CONNECTOR_ID.AUTH&&(this.setCaipAddress(null,e),this.setLoading(!1,e))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:e,type:t})=>{let n=g.ChainController.state.activeChain;if(!n)throw Error("AppKit:onSetPreferredAccount - namespace is required");e&&this.setPreferredAccountType(t,n)})}async syncAuthConnectorTheme(e){if(!e)return;let t=E.ThemeController.getSnapshot();await e.syncTheme({themeMode:t.themeMode,themeVariables:t.themeVariables,w3mThemeVariables:(0,o.getW3mThemeVariables)(t.themeVariables,t.themeMode)})}async syncAuthConnector(e,t){let n=i.ConstantsUtil.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t),r=t===g.ChainController.state.activeChain;if(!n)return;this.setLoading(!0,t);let o=e.getLoginEmailUsed();this.setLoading(o,t),o&&this.setStatus("connecting",t);let s=e.getEmail(),a=e.getUsername(),c=g.ChainController.getAccountData(t)?.user||{};this.setUser({...c,username:a,email:s},t),this.setupAuthConnectorListeners(e);let{isConnected:u}=await e.isConnected();if(t&&n&&r)if(u&&this.connectionControllerClient?.connectExternal){await e.init(),await this.syncAuthConnectorTheme(e),await this.connectionControllerClient?.connectExternal({id:i.ConstantsUtil.CONNECTOR_ID.AUTH,info:{name:i.ConstantsUtil.CONNECTOR_ID.AUTH},type:y.ConstantsUtil.CONNECTOR_TYPE_AUTH,provider:e,chainId:g.ChainController.getNetworkData(t)?.caipNetwork?.id,chain:t}),this.setStatus("connected",t);let n=v.StorageUtil.getConnectedSocialProvider();n?d.EventsController.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",address:this.getAddress(),properties:{provider:n,reconnect:!0}}):d.EventsController.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:this.getAddress(),properties:{method:"email",name:this.universalProvider?.session?.peer?.metadata?.name||"Unknown",reconnect:!0,view:h.RouterController.state.view,walletRank:void 0}})}else l.ConnectorController.getConnectorId(t)===i.ConstantsUtil.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",t),v.StorageUtil.removeConnectedNamespace(t));this.setLoading(!1,t)}async checkExistingTelegramSocialConnection(e){try{if(!r.CoreHelperUtil.isTelegram())return;let t=v.StorageUtil.getTelegramSocialProvider();if(!t||!r.CoreHelperUtil.isClient())return;let n=new URL(window.location.href).searchParams.get("result_uri");if(!n)return;t&&g.ChainController.setAccountProp("socialProvider",t,e),await this.authProvider?.init();let i=l.ConnectorController.getAuthConnector();t&&i&&(this.setLoading(!0,e),await a.ConnectionController.connectExternal({id:i.id,type:i.type,socialUri:n},i.chain),v.StorageUtil.setConnectedSocialProvider(t),v.StorageUtil.removeTelegramSocialProvider(),d.EventsController.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:t}}))}catch(t){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",t)}try{let e=new URL(window.location.href);e.searchParams.delete("result_uri"),window.history.replaceState({},document.title,e.toString())}catch(e){console.error("tma social login failed",e)}}createAuthProvider(e){if(!i.ConstantsUtil.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;let t=this.remoteFeatures?.email,n=Array.isArray(this.remoteFeatures?.socials)&&this.remoteFeatures.socials.length>0,r=N.HelpersUtil.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&this.options?.projectId&&(t||n)&&(this.authProvider=U.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:this.getCaipNetwork(r)?.caipNetworkId,abortController:A.ErrorUtil.EmbeddedWalletAbortController,onTimeout:e=>{"iframe_load_failed"===e?m.AlertController.open(A.ErrorUtil.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):"iframe_request_timeout"===e?m.AlertController.open(A.ErrorUtil.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):"unverified_domain"===e&&m.AlertController.open(A.ErrorUtil.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:e=>(0,p.getActiveCaipNetwork)(e),getCaipNetworks:e=>g.ChainController.getCaipNetworks(e)}),u.PublicStateController.subscribeOpen(e=>{!e&&this.isTransactionStackEmpty()&&this.authProvider?.rejectRpcRequests()}));let o=e===g.ChainController.state.activeChain&&f.OptionsController.state.enableReconnect;!1===f.OptionsController.state.enableReconnect?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&o&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){this.createAuthProvider(e),this.authProvider&&this.chainAdapters?.[e]?.setAuthProvider?.(this.authProvider)}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&s.ApiController.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){if(!e)return;let t=g.ChainController.state.activeChain,n=e.chainNamespace,r=this.getAddressByChainNamespace(n);if(n===t&&g.ChainController.getAccountData(n)?.caipAddress){let t=this.getAdapter(n);await t?.switchNetwork({caipNetwork:e}),this.setCaipNetwork(e)}else{let o=w.ProviderController.getProviderId(t)===y.ConstantsUtil.CONNECTOR_TYPE_AUTH,s=w.ProviderController.getProviderId(n),a=s===y.ConstantsUtil.CONNECTOR_TYPE_AUTH,l=i.ConstantsUtil.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n);if(!n)throw Error("AppKit:switchCaipNetwork - networkNamespace is required");if((o&&void 0===s||a)&&l)try{if(g.ChainController.state.activeChain=e.chainNamespace,r){let t=this.getAdapter(n);await t?.switchNetwork({caipNetwork:e})}else await this.connectionControllerClient?.connectExternal?.({id:i.ConstantsUtil.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:n,chainId:e.id,type:y.ConstantsUtil.CONNECTOR_TYPE_AUTH,caipNetwork:e});this.setCaipNetwork(e)}catch(r){let t=this.getAdapter(n);await t?.switchNetwork({caipNetwork:e})}else if(s===y.ConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT){if(!g.ChainController.state.noAdapters){let t=this.getAdapter(n);await t?.switchNetwork({caipNetwork:e})}this.setCaipNetwork(e),this.syncWalletConnectAccount()}else this.setCaipNetwork(e),r&&this.syncAccount({address:r,chainId:e.id,chainNamespace:n})}}async initialize(e){await super.initialize(e),this.chainNamespaces?.forEach(e=>{this.createAuthProviderForAdapter(e)}),await this.injectModalUi(),u.PublicStateController.set({initialized:!0})}async syncIdentity({address:e,chainId:t,chainNamespace:n}){let r=`${n}:${t}`,o=this.caipNetworks?.find(e=>e.caipNetworkId===r);if(o?.testnet){this.setProfileName(null,n),this.setProfileImage(null,n);return}let s=l.ConnectorController.getConnectorId(n)===i.ConstantsUtil.CONNECTOR_ID.AUTH;try{let{name:t,avatar:r}=await this.fetchIdentity({address:e});!t&&s?await this.syncReownName(e,n):(this.setProfileName(t,n),this.setProfileImage(r,n))}catch{1!==t&&this.setProfileImage(null,n)}}syncConnectedWalletInfo(e){let t=w.ProviderController.getProviderId(e);if(t===y.ConstantsUtil.CONNECTOR_TYPE_AUTH){let n=this.authProvider;if(n){let r=v.StorageUtil.getConnectedSocialProvider()??"email",i=n.getEmail()??n.getUsername();this.setConnectedWalletInfo({name:t,identifier:i,social:r},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(r.CoreHelperUtil.isClient()&&!ec)try{let e={...c.ConstantsUtil.DEFAULT_FEATURES,...this.options.features},t=this.remoteFeatures;if(await this.loadModalComponents(e,t),r.CoreHelperUtil.isClient()&&!document.querySelector("w3m-modal")){let e=document.createElement("w3m-modal");f.OptionsController.state.disableAppend||f.OptionsController.state.enableEmbedded||document.body.insertAdjacentElement("beforeend",e)}ec=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(t,n){if(!r.CoreHelperUtil.isClient())return;let i=[];(n.email||n.socials&&n.socials.length>0)&&i.push(e.A(773348)),n.email&&i.push(e.A(70086)),n.socials&&i.push(e.A(443184)),n.swaps&&n.swaps.length>0&&i.push(e.A(375410)),t.send&&i.push(e.A(64383)),t.receive&&i.push(e.A(387558)),n.onramp&&n.onramp.length>0&&i.push(e.A(483049)),n.payWithExchange&&i.push(e.A(712956)),n.activity&&i.push(e.A(104648)),(t.pay||n.payments)&&i.push(e.A(523499)),n.emailCapture&&i.push(e.A(351913)),await Promise.all([...i,e.A(561290),e.A(449870)])}}var eu=e.i(271645);function eh(e){e&&(t=e)}function eC(){if(!t)throw Error('Please call "createAppKit" before using "useAppKitTheme" hook');let[e,n]=(0,eu.useState)(t.getThemeMode()),[r,i]=(0,eu.useState)(t.getThemeVariables());return(0,eu.useEffect)(()=>{let e=t?.subscribeTheme(e=>{n(e.themeMode),i(e.themeVariables)});return()=>{e?.()}},[]),{themeMode:e,themeVariables:r,setThemeMode:function(e){e&&t?.setThemeMode(e)},setThemeVariables:function(e){e&&t?.setThemeVariables(e)}}}function ep(){if(!t)throw Error('Please call "createAppKit" before using "useAppKit" hook');return{open:async function(e){return t?.open(e)},close:async function(){await t?.close()}}}function em(e){if(!t)throw Error('Please call "createAppKit" before using "useWalletInfo" hook');let[n,r]=(0,eu.useState)(()=>t?.getWalletInfo(e));return(0,eu.useEffect)(()=>{r(t?.getWalletInfo(e));let n=t?.subscribeWalletInfo(e=>{r(e)},e);return()=>n?.()},[e]),{walletInfo:n}}function eg(){if(!t)throw Error('Please call "createAppKit" before using "useAppKitState" hook');let[e,n]=(0,eu.useState)({...t.getState(),initialized:!1}),[r,i]=(0,eu.useState)(t.getRemoteFeatures());return(0,eu.useEffect)(()=>{if(t){n({...t.getState()}),i(t.getRemoteFeatures());let e=t?.subscribeState(e=>{n({...e})}),r=t?.subscribeRemoteFeatures(e=>{i(e)});return()=>{e?.(),r?.()}}return()=>null},[]),{...e,...r??{}}}function ef(){if(!t)throw Error('Please call "createAppKit" before using "useAppKitEvents" hook');let[e,n]=(0,eu.useState)(t.getEvent());return(0,eu.useEffect)(()=>{let e=t?.subscribeEvents(e=>{n({...e})});return()=>{e?.()}},[]),e}e.s(["getAppKit",()=>eh,"useAppKit",()=>ep,"useAppKitEvents",()=>ef,"useAppKitState",()=>eg,"useAppKitTheme",()=>eC,"useWalletInfo",()=>em],747512);let ew=new Set(["children","localName","ref","style","className"]),ev=new WeakMap,eE=(e,t,n,r,i)=>{let o,s,a=i?.[t];void 0===a?(e[t]=n,null==n&&t in HTMLElement.prototype&&e.removeAttribute(t)):n!==r&&(void 0===(o=ev.get(e))&&ev.set(e,o=new Map),s=o.get(a),void 0!==n?void 0===s?(o.set(a,s={handleEvent:n}),e.addEventListener(a,s)):s.handleEvent=n:void 0!==s&&(o.delete(a),e.removeEventListener(a,s)))},eA=({react:e,tagName:t,elementClass:n,events:r,displayName:i})=>{let o=new Set(Object.keys(r??{})),s=e.forwardRef((i,s)=>{let a=e.useRef(new Map),l=e.useRef(null),c={},d={};for(let[e,t]of Object.entries(i))ew.has(e)?c["className"===e?"class":e]=t:o.has(e)||e in n.prototype?d[e]=t:c[e]=t;return e.useLayoutEffect(()=>{if(null===l.current)return;let e=new Map;for(let t in d)eE(l.current,t,i[t],a.current.get(t),r),a.current.delete(t),e.set(t,i[t]);for(let[e,t]of a.current)eE(l.current,e,void 0,t,r);a.current=e}),e.useLayoutEffect(()=>{l.current?.removeAttribute("defer-hydration")},[]),c.suppressHydrationWarning=!0,e.createElement(t,{...c,ref:e.useCallback(e=>{l.current=e,"function"==typeof s?s(e):null!==s&&(s.current=e)},[s])})});return s.displayName=i??n.name,s};e.i(910842);var eN=e.i(237287),ey=e.i(972801),eT=e.i(885873),eb=e.i(619295);function eI(e){return n||eh(n=new ed({...e,sdkVersion:r.CoreHelperUtil.generateSdkVersion(e.adapters??[],"react","1.8.17")})),n}eA({tagName:"appkit-button",elementClass:ey.AppKitButton,react:eu.default}),eA({tagName:"appkit-network-button",elementClass:eb.AppKitNetworkButton,react:eu.default}),eA({tagName:"appkit-connect-button",elementClass:eT.AppKitConnectButton,react:eu.default}),eA({tagName:"appkit-account-button",elementClass:eN.AppKitAccountButton,react:eu.default})},180166,e=>{"use strict";var t={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},n=new class{#e=t;#t=!1;setTimeoutProvider(e){this.#e=e}setTimeout(e,t){return this.#e.setTimeout(e,t)}clearTimeout(e){this.#e.clearTimeout(e)}setInterval(e,t){return this.#e.setInterval(e,t)}clearInterval(e){this.#e.clearInterval(e)}};function r(e){setTimeout(e,0)}e.s(["systemSetTimeoutZero",()=>r,"timeoutManager",()=>n])},619273,e=>{"use strict";var t=e.i(180166),n="u"<typeof window||"Deno"in globalThis;function r(){}function i(e,t){return"function"==typeof e?e(t):e}function o(e){return"number"==typeof e&&e>=0&&e!==1/0}function s(e,t){return Math.max(e+(t||0)-Date.now(),0)}function a(e,t){return"function"==typeof e?e(t):e}function l(e,t){return"function"==typeof e?e(t):e}function c(e,t){let{type:n="all",exact:r,fetchStatus:i,predicate:o,queryKey:s,stale:a}=e;if(s){if(r){if(t.queryHash!==u(s,t.options))return!1}else if(!C(t.queryKey,s))return!1}if("all"!==n){let e=t.isActive();if("active"===n&&!e||"inactive"===n&&e)return!1}return("boolean"!=typeof a||t.isStale()===a)&&(!i||i===t.state.fetchStatus)&&(!o||!!o(t))}function d(e,t){let{exact:n,status:r,predicate:i,mutationKey:o}=e;if(o){if(!t.options.mutationKey)return!1;if(n){if(h(t.options.mutationKey)!==h(o))return!1}else if(!C(t.options.mutationKey,o))return!1}return(!r||t.state.status===r)&&(!i||!!i(t))}function u(e,t){return(t?.queryKeyHashFn||h)(e)}function h(e){return JSON.stringify(e,(e,t)=>f(t)?Object.keys(t).sort().reduce((e,n)=>(e[n]=t[n],e),{}):t)}function C(e,t){return e===t||typeof e==typeof t&&!!e&&!!t&&"object"==typeof e&&"object"==typeof t&&Object.keys(t).every(n=>C(e[n],t[n]))}var p=Object.prototype.hasOwnProperty;function m(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(e[n]!==t[n])return!1;return!0}function g(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function f(e){if(!w(e))return!1;let t=e.constructor;if(void 0===t)return!0;let n=t.prototype;return!!w(n)&&!!n.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype}function w(e){return"[object Object]"===Object.prototype.toString.call(e)}function v(e){return new Promise(n=>{t.timeoutManager.setTimeout(n,e)})}function E(e,t,n){return"function"==typeof n.structuralSharing?n.structuralSharing(e,t):!1!==n.structuralSharing?function e(t,n,r=0){if(t===n)return t;if(r>500)return n;let i=g(t)&&g(n);if(!i&&!(f(t)&&f(n)))return n;let o=(i?t:Object.keys(t)).length,s=i?n:Object.keys(n),a=s.length,l=i?Array(a):{},c=0;for(let d=0;d<a;d++){let a=i?d:s[d],u=t[a],h=n[a];if(u===h){l[a]=u,(i?d<o:p.call(t,a))&&c++;continue}if(null===u||null===h||"object"!=typeof u||"object"!=typeof h){l[a]=h;continue}let C=e(u,h,r+1);l[a]=C,C===u&&c++}return o===a&&c===o?t:l}(e,t):t}function A(e,t,n=0){let r=[...e,t];return n&&r.length>n?r.slice(1):r}function N(e,t,n=0){let r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var y=Symbol();function T(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==y?e.queryFn:()=>Promise.reject(Error(`Missing queryFn: '${e.queryHash}'`))}function b(e,t){return"function"==typeof e?e(...t):!!e}function I(e,t,n){let r,i=!1;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(r??=t(),i||(i=!0,r.aborted?n():r.addEventListener("abort",n,{once:!0})),r)}),e}e.s(["addConsumeAwareSignal",()=>I,"addToEnd",()=>A,"addToStart",()=>N,"ensureQueryFn",()=>T,"functionalUpdate",()=>i,"hashKey",()=>h,"hashQueryKeyByOptions",()=>u,"isServer",()=>n,"isValidTimeout",()=>o,"matchMutation",()=>d,"matchQuery",()=>c,"noop",()=>r,"partialMatchKey",()=>C,"replaceData",()=>E,"resolveEnabled",()=>l,"resolveStaleTime",()=>a,"shallowEqualObjects",()=>m,"shouldThrowError",()=>b,"skipToken",()=>y,"sleep",()=>v,"timeUntilStale",()=>s])},540143,e=>{"use strict";let t,n,r,i,o,s;var a=e.i(180166).systemSetTimeoutZero,l=(t=[],n=0,r=e=>{e()},i=e=>{e()},o=a,{batch:e=>{let s;n++;try{s=e()}finally{let e;--n||(e=t,t=[],e.length&&o(()=>{i(()=>{e.forEach(e=>{r(e)})})}))}return s},batchCalls:e=>(...t)=>{s(()=>{e(...t)})},schedule:s=e=>{n?t.push(e):o(()=>{r(e)})},setNotifyFunction:e=>{r=e},setBatchNotifyFunction:e=>{i=e},setScheduler:e=>{o=e}});e.s(["notifyManager",()=>l])},936553,915823,175555,814448,e=>{"use strict";var t=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}};e.s(["Subscribable",()=>t],915823);var n=e.i(619273),r=new class extends t{#n;#r;#i;constructor(){super(),this.#i=e=>{if(!n.isServer&&window.addEventListener){let t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#r||this.setEventListener(this.#i)}onUnsubscribe(){this.hasListeners()||(this.#r?.(),this.#r=void 0)}setEventListener(e){this.#i=e,this.#r?.(),this.#r=e(e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()})}setFocused(e){this.#n!==e&&(this.#n=e,this.onFocus())}onFocus(){let e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return"boolean"==typeof this.#n?this.#n:globalThis.document?.visibilityState!=="hidden"}};e.s(["focusManager",()=>r],175555);var i=new class extends t{#o=!0;#r;#i;constructor(){super(),this.#i=e=>{if(!n.isServer&&window.addEventListener){let t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#r||this.setEventListener(this.#i)}onUnsubscribe(){this.hasListeners()||(this.#r?.(),this.#r=void 0)}setEventListener(e){this.#i=e,this.#r?.(),this.#r=e(this.setOnline.bind(this))}setOnline(e){this.#o!==e&&(this.#o=e,this.listeners.forEach(t=>{t(e)}))}isOnline(){return this.#o}};function o(e){return Math.min(1e3*2**e,3e4)}function s(e){return(e??"online")!=="online"||i.isOnline()}e.s(["onlineManager",()=>i],814448);var a=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function l(e){let t,l=!1,c=0,d=function(){let e,t,n=new Promise((n,r)=>{e=n,t=r});function r(e){Object.assign(n,e),delete n.resolve,delete n.reject}return n.status="pending",n.catch(()=>{}),n.resolve=t=>{r({status:"fulfilled",value:t}),e(t)},n.reject=e=>{r({status:"rejected",reason:e}),t(e)},n}(),u=()=>r.isFocused()&&("always"===e.networkMode||i.isOnline())&&e.canRun(),h=()=>s(e.networkMode)&&e.canRun(),C=e=>{"pending"===d.status&&(t?.(),d.resolve(e))},p=e=>{"pending"===d.status&&(t?.(),d.reject(e))},m=()=>new Promise(n=>{t=e=>{("pending"!==d.status||u())&&n(e)},e.onPause?.()}).then(()=>{t=void 0,"pending"===d.status&&e.onContinue?.()}),g=()=>{let t;if("pending"!==d.status)return;let r=0===c?e.initialPromise:void 0;try{t=r??e.fn()}catch(e){t=Promise.reject(e)}Promise.resolve(t).then(C).catch(t=>{if("pending"!==d.status)return;let r=e.retry??3*!n.isServer,i=e.retryDelay??o,s="function"==typeof i?i(c,t):i,a=!0===r||"number"==typeof r&&c<r||"function"==typeof r&&r(c,t);l||!a?p(t):(c++,e.onFail?.(c,t),(0,n.sleep)(s).then(()=>u()?void 0:m()).then(()=>{l?p(t):g()}))})};return{promise:d,status:()=>d.status,cancel:t=>{if("pending"===d.status){let n=new a(t);p(n),e.onCancel?.(n)}},continue:()=>(t?.(),d),cancelRetry:()=>{l=!0},continueRetry:()=>{l=!1},canStart:h,start:()=>(h()?g():m().then(g),d)}}e.s(["CancelledError",()=>a,"canFetch",()=>s,"createRetryer",()=>l],936553)},88587,e=>{"use strict";var t=e.i(180166),n=e.i(619273),r=class{#s;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),(0,n.isValidTimeout)(this.gcTime)&&(this.#s=t.timeoutManager.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(n.isServer?1/0:3e5))}clearGcTimeout(){this.#s&&(t.timeoutManager.clearTimeout(this.#s),this.#s=void 0)}};e.s(["Removable",()=>r])},114272,e=>{"use strict";var t=e.i(540143),n=e.i(88587),r=e.i(936553),i=class extends n.Removable{#a;#l;#c;#d;constructor(e){super(),this.#a=e.client,this.mutationId=e.mutationId,this.#c=e.mutationCache,this.#l=[],this.state=e.state||o(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#l.includes(e)||(this.#l.push(e),this.clearGcTimeout(),this.#c.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#l=this.#l.filter(t=>t!==e),this.scheduleGc(),this.#c.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#l.length||("pending"===this.state.status?this.scheduleGc():this.#c.remove(this))}continue(){return this.#d?.continue()??this.execute(this.state.variables)}async execute(e){let t=()=>{this.#u({type:"continue"})},n={client:this.#a,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#d=(0,r.createRetryer)({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(Error("No mutationFn found")),onFail:(e,t)=>{this.#u({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#u({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#c.canRun(this)});let i="pending"===this.state.status,o=!this.#d.canStart();try{if(i)t();else{this.#u({type:"pending",variables:e,isPaused:o}),this.#c.config.onMutate&&await this.#c.config.onMutate(e,this,n);let t=await this.options.onMutate?.(e,n);t!==this.state.context&&this.#u({type:"pending",context:t,variables:e,isPaused:o})}let r=await this.#d.start();return await this.#c.config.onSuccess?.(r,e,this.state.context,this,n),await this.options.onSuccess?.(r,e,this.state.context,n),await this.#c.config.onSettled?.(r,null,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(r,null,e,this.state.context,n),this.#u({type:"success",data:r}),r}catch(t){try{await this.#c.config.onError?.(t,e,this.state.context,this,n)}catch(e){Promise.reject(e)}try{await this.options.onError?.(t,e,this.state.context,n)}catch(e){Promise.reject(e)}try{await this.#c.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this,n)}catch(e){Promise.reject(e)}try{await this.options.onSettled?.(void 0,t,e,this.state.context,n)}catch(e){Promise.reject(e)}throw this.#u({type:"error",error:t}),t}finally{this.#c.runNext(this)}}#u(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),t.notifyManager.batch(()=>{this.#l.forEach(t=>{t.onMutationUpdate(e)}),this.#c.notify({mutation:this,type:"updated",action:e})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}e.s(["Mutation",()=>i,"getDefaultState",()=>o])},912598,e=>{"use strict";var t=e.i(271645),n=e.i(474076),r=t.createContext(void 0),i=e=>{let n=t.useContext(r);if(e)return e;if(!n)throw Error("No QueryClient set, use QueryClientProvider to set one");return n},o=({client:e,children:i})=>(t.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),(0,n.jsx)(r.Provider,{value:e,children:i}));e.s(["QueryClientProvider",()=>o,"useQueryClient",()=>i])},574983,337917,e=>{"use strict";var t=e.i(271645);let n=!1;async function r(e,t={}){let i;if(n)return[];n=!0,e.setState(e=>({...e,status:e.current?"reconnecting":"connecting"}));let o=[];if(t.connectors?.length)for(let n of t.connectors){let t;t="function"==typeof n?e._internal.connectors.setup(n):n,o.push(t)}else o.push(...e.connectors);try{i=await e.storage?.getItem("recentConnectorId")}catch{}let s={};for(let[,t]of e.state.connections)s[t.connector.id]=1;i&&(s[i]=0);let a=Object.keys(s).length>0?[...o].sort((e,t)=>(s[e.id]??10)-(s[t.id]??10)):o,l=!1,c=[],d=[];for(let t of a){let n=await t.getProvider().catch(()=>void 0);if(!n||d.some(e=>e===n)||!await t.isAuthorized())continue;let r=await t.connect({isReconnecting:!0}).catch(()=>null);r&&(t.emitter.off("connect",e._internal.events.connect),t.emitter.on("change",e._internal.events.change),t.emitter.on("disconnect",e._internal.events.disconnect),e.setState(e=>{let n=new Map(l?e.connections:new Map).set(t.uid,{accounts:r.accounts,chainId:r.chainId,connector:t});return{...e,current:l?e.current:t.uid,connections:n}}),c.push({accounts:r.accounts,chainId:r.chainId,connector:t}),d.push(n),l=!0)}return("reconnecting"===e.state.status||"connecting"===e.state.status)&&(l?e.setState(e=>({...e,status:"connected"})):e.setState(e=>({...e,connections:new Map,current:null,status:"disconnected"}))),n=!1,c}function i(e){let{children:n,config:i,initialState:o,reconnectOnMount:s=!0}=e,{onMount:a}=function(e,t){let{initialState:n,reconnectOnMount:i}=t;return n&&!e._internal.store.persist.hasHydrated()&&e.setState({...n,chainId:e.chains.some(e=>e.id===n.chainId)?n.chainId:e.chains[0].id,connections:i?n.connections:new Map,status:i?"reconnecting":"disconnected"}),{async onMount(){e._internal.ssr&&(await e._internal.store.persist.rehydrate(),e._internal.mipd&&e._internal.connectors.setState(t=>{let n=new Set;for(let e of t??[])if(e.rdns)for(let t of Array.isArray(e.rdns)?e.rdns:[e.rdns])n.add(t);let r=[];for(let t of e._internal.mipd?.getProviders()??[]){if(n.has(t.info.rdns))continue;let i=e._internal.connectors.providerDetailToConnector(t),o=e._internal.connectors.setup(i);r.push(o)}return[...t,...r]})),i?r(e):e.storage&&e.setState(e=>({...e,connections:new Map}))}}}(i,{initialState:o,reconnectOnMount:s});i._internal.ssr||a();let l=(0,t.useRef)(!0);return(0,t.useEffect)(()=>{if(l.current&&i._internal.ssr)return a(),()=>{l.current=!1}},[]),n}e.s(["reconnect",()=>r],337917);let o=(0,t.createContext)(void 0);function s(e){let{children:n,config:r}=e;return(0,t.createElement)(i,e,(0,t.createElement)(o.Provider,{value:r},n))}e.s(["WagmiContext",0,o,"WagmiProvider",()=>s],574983)},123555,e=>{"use strict";function t(e){let t=e.state.current,n=e.state.connections.get(t),r=n?.accounts,i=r?.[0],o=e.chains.find(e=>e.id===n?.chainId),s=e.state.status;switch(s){case"connected":return{address:i,addresses:r,chain:o,chainId:n?.chainId,connector:n?.connector,isConnected:!0,isConnecting:!1,isDisconnected:!1,isReconnecting:!1,status:s};case"reconnecting":return{address:i,addresses:r,chain:o,chainId:n?.chainId,connector:n?.connector,isConnected:!!i,isConnecting:!1,isDisconnected:!1,isReconnecting:!0,status:s};case"connecting":return{address:i,addresses:r,chain:o,chainId:n?.chainId,connector:n?.connector,isConnected:!1,isConnecting:!0,isDisconnected:!1,isReconnecting:!1,status:s};case"disconnected":return{address:void 0,addresses:void 0,chain:void 0,chainId:void 0,connector:void 0,isConnected:!1,isConnecting:!1,isDisconnected:!0,isReconnecting:!1,status:s}}}e.s(["getConnection",()=>t])},426254,e=>{"use strict";function t(e,t,n){let r=e[t.name];if("function"==typeof r)return r;let i=e[n];return"function"==typeof i?i:n=>t(e,n)}e.s(["getAction",()=>t])},365087,e=>{"use strict";e.s(["deepEqual",()=>function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){let r,i;if(t.constructor!==n.constructor)return!1;if(Array.isArray(t)&&Array.isArray(n)){if((r=t.length)!==n.length)return!1;for(i=r;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if("function"==typeof t.valueOf&&t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if("function"==typeof t.toString&&t.toString!==Object.prototype.toString)return t.toString()===n.toString();let o=Object.keys(t);if((r=o.length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.hasOwn(n,o[i]))return!1;for(i=r;0!=i--;){let r=o[i];if(r&&!e(t[r],n[r]))return!1}return!0}return t!=t&&n!=n}])},324307,e=>{"use strict";var t=e.i(365087);let n=[];function r(e){let r=[...e.state.connections.values()];return"reconnecting"===e.state.status||(0,t.deepEqual)(n,r)?n:(n=r,r)}e.s(["getConnections",()=>r])},44563,e=>{"use strict";var t=e.i(363625),n=e.i(911347),r=e.i(823838),i=e.i(189991),o=e.i(206148);async function s(e,a={}){let l,{assertChainId:c=!0}=a;if(a.connector){let{connector:t}=a;if("reconnecting"===e.state.status&&!t.getAccounts&&!t.getChainId)throw new o.ConnectorUnavailableReconnectingError({connector:t});let[n,r]=await Promise.all([t.getAccounts().catch(e=>{if(null===a.account)return[];throw e}),t.getChainId()]);l={accounts:n,chainId:r,connector:t}}else l=e.state.connections.get(e.state.current);if(!l)throw new o.ConnectorNotConnectedError;let d=a.chainId??l.chainId,u=await l.connector.getChainId();if(c&&u!==d)throw new o.ConnectorChainMismatchError({connectionChainId:d,connectorChainId:u});let h=l.connector;if(h.getClient)return h.getClient({chainId:d});let C=(0,i.parseAccount)(a.account??l.accounts[0]);if(C&&(C.address=(0,r.getAddress)(C.address)),a.account&&!l.accounts.some(e=>e.toLowerCase()===C.address.toLowerCase()))throw new o.ConnectorAccountNotFoundError({address:C.address,connector:h});let p=e.chains.find(e=>e.id===d),m=await l.connector.getProvider({chainId:d});return(0,t.createClient)({account:C,chain:p,name:"Connector Client",transport:e=>(0,n.custom)(m)({...e,retryCount:0})})}e.s(["getConnectorClient",()=>s])},6110,e=>{"use strict";async function t(e,n={}){let r;if(n.connector)r=n.connector;else{let{connections:t,current:n}=e.state,i=t.get(n);r=i?.connector}let i=e.state.connections;r&&(await r.disconnect(),r.emitter.off("change",e._internal.events.change),r.emitter.off("disconnect",e._internal.events.disconnect),r.emitter.on("connect",e._internal.events.connect),i.delete(r.uid)),e.setState(e=>{if(0===i.size)return{...e,connections:new Map,current:null,status:"disconnected"};let t=i.values().next().value;return{...e,connections:new Map(i),current:t.connector.uid}});{let t=e.state.current;if(!t)return;let n=e.state.connections.get(t)?.connector;if(!n)return;await e.storage?.setItem("recentConnectorId",n.id)}}e.s(["disconnect",()=>t])},117504,e=>{"use strict";var t=e.i(888794),n=e.i(426254),r=e.i(44563);async function i(e,i){let o,{account:s,chainId:a,connector:l,...c}=i;o="object"==typeof s&&s?.type==="local"?e.getClient({chainId:a}):await (0,r.getConnectorClient)(e,{account:s??void 0,assertChainId:!1,chainId:a,connector:l});let d=a&&o.chain?.id!==a?{id:a}:o.chain,u=(0,n.getAction)(o,t.sendTransaction,"sendTransaction");return await u({...c,...s?{account:s}:{},assertChainId:!!a,chain:d,gas:c.gas??void 0})}e.s(["sendTransaction",()=>i])},225580,e=>{"use strict";var t=e.i(365087),n=e.i(123555);function r(e,r){let{onChange:i}=r;return e.subscribe(()=>(0,n.getConnection)(e),i,{equalityFn(e,n){let{connector:r,...i}=e,{connector:o,...s}=n;return(0,t.deepEqual)(i,s)&&r?.id===o?.id&&r?.uid===o?.uid}})}e.s(["watchConnection",()=>r])},331587,e=>{"use strict";var t=e.i(365087),n=e.i(324307);function r(e,r){let{onChange:i}=r;return e.subscribe(()=>(0,n.getConnections)(e),i,{equalityFn:t.deepEqual})}e.s(["watchConnections",()=>r])},377379,(e,t,n)=>{"use strict";var r=e.r(271645),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=r.useState,s=r.useEffect,a=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(e){return!0}}var d="u"<typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=o({inst:{value:n,getSnapshot:t}}),i=r[0].inst,d=r[1];return a(function(){i.value=n,i.getSnapshot=t,c(i)&&d({inst:i})},[e,n,t]),s(function(){return c(i)&&d({inst:i}),e(function(){c(i)&&d({inst:i})})},[e]),l(n),n};n.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:d},193490,(e,t,n)=>{"use strict";t.exports=e.r(377379)},731097,(e,t,n)=>{"use strict";var r=e.r(271645),i=e.r(193490),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=i.useSyncExternalStore,a=r.useRef,l=r.useEffect,c=r.useMemo,d=r.useDebugValue;n.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var u=a(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;var C=s(e,(u=c(function(){function e(e){if(!l){if(l=!0,s=e,e=r(e),void 0!==i&&h.hasValue){var t=h.value;if(i(t,e))return a=t}return a=e}if(t=a,o(s,e))return t;var n=r(e);return void 0!==i&&i(t,n)?(s=e,t):(s=e,a=n)}var s,a,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,r,i]))[0],u[1]);return l(function(){h.hasValue=!0,h.value=C},[C]),d(C),C}},451797,(e,t,n)=>{"use strict";t.exports=e.r(731097)},612573,210920,170778,e=>{"use strict";var t=e.i(123555),n=e.i(225580),r=e.i(271645),i=e.i(574983),o=e.i(191346);class s extends o.BaseError{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiError"})}get docsBaseUrl(){return"https://wagmi.sh/react"}get version(){return"wagmi@3.4.1"}}class a extends s{constructor(){super("`useConfig` must be used within `WagmiProvider`.",{docsPath:"/api/WagmiProvider"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiProviderNotFoundError"})}}function l(e={}){let t=e.config??(0,r.useContext)(i.WagmiContext);if(!t)throw new a;return t}e.s(["useConfig",()=>l],210920);var c=e.i(365087),d=e.i(451797);let u=e=>"object"==typeof e&&!Array.isArray(e);function h(e={}){let i=l(e);return function(e,t,n=t,i=c.deepEqual){let o=(0,r.useRef)([]),s=(0,d.useSyncExternalStoreWithSelector)(e,t,n,e=>e,(e,t)=>{if(u(e)&&u(t)&&o.current.length){for(let n of o.current)if(!i(e[n],t[n]))return!1;return!0}return i(e,t)});return(0,r.useMemo)(()=>{if(u(s)){let e={...s},t={};for(let[n,r]of Object.entries(e))t={...t,[n]:{configurable:!1,enumerable:!0,get:()=>(o.current.includes(n)||o.current.push(n),r)}};return Object.defineProperties(e,t),e}return s},[s])}(e=>(0,n.watchConnection)(i,{onChange:e}),()=>(0,t.getConnection)(i))}function C(e){return e.state.chainId}function p(e={}){let t=l(e);return(0,r.useSyncExternalStore)(e=>(function(e,t){let{onChange:n}=t;return e.subscribe(e=>e.chainId,n)})(t,{onChange:e}),()=>C(t),()=>C(t))}e.s(["useAccount",()=>h],612573),e.s(["useChainId",()=>p],170778)},556345,e=>{"use strict";var t=e.i(114272),n=e.i(540143),r=e.i(915823),i=e.i(619273),o=class extends r.Subscribable{#a;#h=void 0;#C;#p;constructor(e,t){super(),this.#a=e,this.setOptions(t),this.bindMethods(),this.#m()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#a.defaultMutationOptions(e),(0,i.shallowEqualObjects)(this.options,t)||this.#a.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#C,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,i.hashKey)(t.mutationKey)!==(0,i.hashKey)(this.options.mutationKey)?this.reset():this.#C?.state.status==="pending"&&this.#C.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#C?.removeObserver(this)}onMutationUpdate(e){this.#m(),this.#g(e)}getCurrentResult(){return this.#h}reset(){this.#C?.removeObserver(this),this.#C=void 0,this.#m(),this.#g()}mutate(e,t){return this.#p=t,this.#C?.removeObserver(this),this.#C=this.#a.getMutationCache().build(this.#a,this.options),this.#C.addObserver(this),this.#C.execute(e)}#m(){let e=this.#C?.state??(0,t.getDefaultState)();this.#h={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#g(e){n.notifyManager.batch(()=>{if(this.#p&&this.hasListeners()){let t=this.#h.variables,n=this.#h.context,r={client:this.#a,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#p.onSuccess?.(e.data,t,n,r)}catch(e){Promise.reject(e)}try{this.#p.onSettled?.(e.data,null,t,n,r)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#p.onError?.(e.error,t,n,r)}catch(e){Promise.reject(e)}try{this.#p.onSettled?.(void 0,e.error,t,n,r)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#h)})})}};e.s(["MutationObserver",()=>o])},954616,e=>{"use strict";var t=e.i(271645),n=e.i(556345),r=e.i(619273),i=e.i(540143),o=e.i(912598);function s(e,s){let a=(0,o.useQueryClient)(s),[l]=t.useState(()=>new n.MutationObserver(a,e));t.useEffect(()=>{l.setOptions(e)},[l,e]);let c=t.useSyncExternalStore(t.useCallback(e=>l.subscribe(i.notifyManager.batchCalls(e)),[l]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),d=t.useCallback((e,t)=>{l.mutate(e,t).catch(r.noop)},[l]);if(c.error&&(0,r.shouldThrowError)(l.options.throwOnError,[c.error]))throw c.error;return{...c,mutate:d,mutateAsync:c.mutate}}e.s(["useMutation",()=>s])},580607,e=>{"use strict";var t=e.i(6110);function n(e,r={}){return{...r.mutation,mutationFn:async n=>(0,t.disconnect)(e,n),mutationKey:["disconnect"]}}e.s(["disconnectMutationOptions",()=>n])},249994,e=>{"use strict";var t=e.i(954616),n=e.i(580607),r=e.i(210920),i=e.i(324307),o=e.i(331587),s=e.i(271645);function a(e={}){let l=(0,r.useConfig)(e),c=(0,n.disconnectMutationOptions)(l,e),d=(0,t.useMutation)(c);return{...d,connectors:(function(e={}){let t=(0,r.useConfig)(e);return(0,s.useSyncExternalStore)(e=>(0,o.watchConnections)(t,{onChange:e}),()=>(0,i.getConnections)(t),()=>(0,i.getConnections)(t))})({config:l}).map(e=>e.connector),disconnect:d.mutate,disconnectAsync:d.mutateAsync}}e.s(["useDisconnect",()=>a],249994)},574253,e=>{"use strict";var t=e.i(954616),n=e.i(117504),r=e.i(210920);function i(e={}){let o=function(e,t={}){return{...t.mutation,mutationFn:t=>(0,n.sendTransaction)(e,t),mutationKey:["sendTransaction"]}}((0,r.useConfig)(e),e),s=(0,t.useMutation)(o);return{...s,sendTransaction:s.mutate,sendTransactionAsync:s.mutateAsync}}e.s(["useSendTransaction",()=>i],574253)},609534,427795,e=>{"use strict";var t=e.i(747512),n=e.i(271645),r=e.i(344169),i=e.i(365801);let o={get url(){return`file://${e.P("node_modules/valtio/esm/react.mjs")}`}},s=new WeakMap;function a(e,t){let a,l=null==t?void 0:t.sync,c=(0,n.useMemo)(()=>e&&new WeakMap,[e]),d=(0,n.useRef)(void 0),u=!0,h=(0,n.useSyncExternalStore)((0,n.useCallback)(t=>{let n=(0,i.subscribe)(e,t,l);return t(),n},[e,l]),()=>{let t=(0,i.snapshot)(e);try{if(!u&&d.current&&!(0,r.isChanged)(d.current,t,c,new WeakMap))return d.current}catch(e){}return t},()=>(0,i.snapshot)(e));u=!1,(0,n.useLayoutEffect)(()=>{d.current=h}),(o.env?o.env.MODE:void 0)!=="production"&&(a=(0,n.useRef)(void 0),(0,n.useEffect)(()=>{a.current=(0,r.affectedToPathList)(h,c,!0)}),(0,n.useDebugValue)(a.current));let C=(0,n.useMemo)(()=>new WeakMap,[]);return(0,r.createProxy)(h,c,C,s)}var l=e.i(401564),c=e.i(851887),d=e.i(886259),u=e.i(241845),h=e.i(960398),C=e.i(971080),p=e.i(149454),m=e.i(82283),g=e.i(462579),f=e.i(77277),w=e.i(436220),v=e.i(770850),E=e.i(197730);let A={getInitialWallets(){return v.ConnectorUtil.connectorList().map(e=>"connector"===e.kind?this.mapConnectorToWalletItem(e.connector,e.subtype):"wallet"===e.kind?this.mapWalletToWalletItem(e.wallet):null).filter(Boolean)},getWalletConnectWallets(e,t){return t.length>0?t.map(e=>this.mapWalletToWalletItem(e)):E.WalletUtil.getWalletConnectWallets(e).map(e=>this.mapWalletToWalletItem(e))},serializeWcWallet:e=>e?{walletInfo:{description:e.description,supportedChains:e.chains,website:e.homepage,installationLinks:{appStore:e.app_store,playStore:e.play_store,chromeStore:e.chrome_store,desktopLink:e.desktop_link},deepLink:e.mobile_link,linkMode:e.link_mode,isCertified:"certified"===e.badge_type,supportsWcPay:e.supports_wcpay??!1}}:{walletInfo:{}},mapConnectorToWalletItem(e,t){let n=e.connectors?.length?e.connectors?.map(e=>({id:e.id,chain:e.chain,chainImageUrl:w.AssetUtil.getChainNamespaceImageUrl(e.chain)}))||[]:[{id:e.id,chain:e.chain,chainImageUrl:w.AssetUtil.getChainNamespaceImageUrl(e.chain)}];return{id:e.id,connectors:"walletConnect"===t?[]:n,name:e.name,imageUrl:e.imageUrl||w.AssetUtil.getAssetImageUrl(e.imageId),imageId:e.imageId,isInjected:"walletConnect"!==t,isRecent:!1,...this.serializeWcWallet(e.explorerWallet)}},mapWalletToWalletItem(e){return{id:e.id,connectors:[],name:e.name,imageUrl:w.AssetUtil.getWalletImageUrl(e.image_id),imageId:e.image_id,isInjected:!1,isRecent:!1,...this.serializeWcWallet(e)}},mapWalletItemToWcWallet:e=>({id:e.id,name:e.name,image_id:e.imageId,image_url:e.imageUrl,description:e.walletInfo.description,mobile_link:e.walletInfo.deepLink,link_mode:e.walletInfo.linkMode??null,chains:e.walletInfo.supportedChains})};var N=e.i(210087),y=e.i(468883),T=e.i(227302),b=e.i(411249),I=e.i(758331);function U(e){let{providers:t,providerIds:n}=a(g.ProviderController.state);return{walletProvider:t[e],walletProviderType:n[e]}}function O(){let{activeCaipNetwork:e}=a(h.ChainController.state);return{caipNetwork:e,chainId:e?.id,caipNetworkId:e?.caipNetworkId}}function S(e){let t=a(h.ChainController.state),{activeConnectorIds:n}=a(p.ConnectorController.state),r=e?.namespace||t.activeChain;if(!r)return{allAccounts:[],address:void 0,caipAddress:void 0,status:void 0,isConnected:!1,embeddedWalletInfo:void 0};let i=t.chains.get(r)?.accountState,o=p.ConnectorController.getAuthConnector(r),s=n[r];return{allAccounts:C.ConnectionController.getConnections(r).flatMap(e=>e.accounts.map(({address:e,type:t,publicKey:n})=>T.CoreHelperUtil.createAccount(r,e,t||"eoa",n))),caipAddress:i?.caipAddress,address:T.CoreHelperUtil.getPlainAddress(i?.caipAddress),isConnected:!!i?.caipAddress,status:i?.status,embeddedWalletInfo:o&&s===l.ConstantsUtil.CONNECTOR_ID.AUTH?{user:i?.user?{...i.user,username:I.StorageUtil.getConnectedSocialUsername()}:void 0,authProvider:i?.socialProvider||"email",accountType:i?.preferredAccountType,isSmartAccountDeployed:!!i?.smartAccountDeployed}:void 0}}function P(){return{disconnect:async function(e){await C.ConnectionController.disconnect(e)}}}function k(e){a(C.ConnectionController.state),a(p.ConnectorController.state),a(u.AssetController.state);let{activeChain:t}=a(h.ChainController.state),{remoteFeatures:r}=a(m.OptionsController.state),i=e??t,o=!!r?.multiWallet;if(!i)throw Error("No namespace found");let s=(0,n.useCallback)(e=>{let t=p.ConnectorController.getConnectorById(e.connectorId),n=p.ConnectorController.getConnectorName(t?.name);return{name:n,icon:w.AssetUtil.getConnectorImage(t),networkIcon:w.AssetUtil.getNetworkImage(e.caipNetwork),...e}},[]),{connections:d,recentConnections:g}=N.ConnectionControllerUtil.getConnectionsData(i);return o?{connections:d.map(s),recentConnections:g.map(s)}:(c.AlertController.open(l.ConstantsUtil.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.CONNECTIONS_HOOK,"info"),{connections:[],recentConnections:[]})}function _({namespace:e,onSuccess:t,onError:r}){let{connections:i,isSwitchingConnection:o}=a(C.ConnectionController.state),{activeConnectorIds:s}=a(p.ConnectorController.state),{activeChain:d}=a(h.ChainController.state),{remoteFeatures:u}=a(m.OptionsController.state),g=e??d;if(!g)throw Error("No namespace found");let f=!!u?.multiWallet,w=(0,n.useCallback)(async({connection:e,address:n})=>{try{C.ConnectionController.setIsSwitchingConnection(!0),await C.ConnectionController.switchConnection({connection:e,address:n,namespace:g,onChange({address:e,namespace:n,hasSwitchedAccount:r,hasSwitchedWallet:i}){t?.({address:e,namespace:n,hasSwitchedAccount:r,hasSwitchedWallet:i,hasDeletedWallet:!1})}})}catch(t){let e=t instanceof Error?t:Error("Something went wrong");r?.(e)}finally{C.ConnectionController.setIsSwitchingConnection(!1)}},[g,t,r]),v=(0,n.useCallback)(({address:e,connectorId:n})=>{I.StorageUtil.deleteAddressFromConnection({connectorId:n,address:e,namespace:g}),C.ConnectionController.syncStorageConnections(),t?.({address:e,namespace:g,hasSwitchedAccount:!1,hasSwitchedWallet:!1,hasDeletedWallet:!0})},[g]);if(!f)return c.AlertController.open(l.ConstantsUtil.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.CONNECTION_HOOK,"info"),{connection:void 0,isPending:!1,switchConnection:()=>Promise.resolve(void 0),deleteConnection:()=>({})};let E=s[g],A=i.get(g);return{connection:A?.find(e=>e.connectorId.toLowerCase()===E?.toLowerCase()),isPending:o,switchConnection:w,deleteConnection:v}}function R(){let{features:e,remoteFeatures:t}=a(m.OptionsController.state),r=!!(e?.headless&&t?.headless),[i,o]=(0,n.useState)(!1),[s,u]=(0,n.useState)(void 0),{wcUri:h,wcFetchingUri:g}=a(C.ConnectionController.state),{wallets:w,search:v,page:E,count:I}=a(d.ApiController.state),{initialized:U,connectingWallet:O}=a(f.PublicStateController.state);async function S(){_(),await C.ConnectionController.connectWalletConnect({cache:"auto"})}async function P(e){o(!0);try{e?.query?await d.ApiController.searchWallet({search:e?.query}):(d.ApiController.state.search=[],await d.ApiController.fetchWalletsByPage({page:e?.page??1}))}catch(e){console.error("Failed to fetch WalletConnect wallets:",e)}finally{o(!1)}}async function k(e,t,n){u(n?.wcPayUrl),f.PublicStateController.set({connectingWallet:e});let r=T.CoreHelperUtil.isMobile();try{let i=e?.connectors.find(e=>e.chain===t),o=i&&t?p.ConnectorController.getConnector({id:i?.id,namespace:t}):void 0;if(e?.isInjected&&o)await y.ConnectorControllerUtil.connectExternal(o);else if(r){let r=A.mapWalletItemToWcWallet(e);r.mobile_link?N.ConnectionControllerUtil.onConnectMobile(r,n?.wcPayUrl):b.MobileWalletUtil.handleMobileDeeplinkRedirect(e.id,t)}else await C.ConnectionController.connectWalletConnect({cache:"never"})}catch(e){throw f.PublicStateController.set({connectingWallet:void 0}),e}}function _(){C.ConnectionController.resetUri(),C.ConnectionController.setWcLinking(void 0),u(void 0)}function R(){f.PublicStateController.set({connectingWallet:void 0})}(0,n.useEffect)(()=>{!U||t?.headless===void 0||r&&t?.headless||c.AlertController.open(l.ConstantsUtil.REMOTE_FEATURES_ALERTS.HEADLESS_NOT_ENABLED.DEFAULT,"info")},[U,r,t?.headless]);let L=s&&h?T.CoreHelperUtil.appendPayToUri(h,s):h;return r&&t?.headless?{wallets:A.getInitialWallets(),wcWallets:A.getWalletConnectWallets(w,v),isFetchingWallets:i,isFetchingWcUri:g,isInitialized:U,wcUri:L,connectingWallet:O,page:E,count:I,connect:k,fetchWallets:P,resetWcUri:_,resetConnectingWallet:R,getWcUri:S}:{wallets:[],wcWallets:[],isFetchingWallets:!1,isFetchingWcUri:!1,isInitialized:!1,wcUri:void 0,connectingWallet:void 0,page:0,count:0,connect:()=>Promise.resolve(),fetchWallets:()=>Promise.resolve(),resetWcUri:_,resetConnectingWallet:R,getWcUri:()=>Promise.resolve()}}e.s(["useAppKitAccount",()=>S,"useAppKitConnection",()=>_,"useAppKitConnections",()=>k,"useAppKitNetworkCore",()=>O,"useAppKitProvider",()=>U,"useAppKitWallets",()=>R,"useDisconnect",()=>P],215015),e.i(215015),e.s(["useAppKit",()=>t.useAppKit],609534);var L=e.i(538463);let W=(0,L.defineChain)({id:42,name:"LUKSO",nativeCurrency:{decimals:18,name:"LYX",symbol:"LYX"},rpcUrls:{default:{http:["https://rpc.mainnet.lukso.network"]}},blockExplorers:{default:{name:"LUKSO Explorer",url:"https://explorer.execution.mainnet.lukso.network"}}}),M=(0,L.defineChain)({id:4201,name:"LUKSO Testnet",nativeCurrency:{decimals:18,name:"LYXt",symbol:"LYXt"},rpcUrls:{default:{http:["https://rpc.testnet.lukso.network"]}},blockExplorers:{default:{name:"LUKSO Testnet Explorer",url:"https://explorer.execution.testnet.lukso.network"}},testnet:!0});e.s(["lukso",0,W,"luksoTestnet",0,M],427795)},558698,e=>{"use strict";var t=e.i(247167);let n={mainnet:{rpc:"https://rpc.mainnet.lukso.network",indexer:"https://envio.lukso-mainnet.universal.tech/v1/graphql",explorer:"https://explorer.execution.mainnet.lukso.network",explorerApi:"https://explorer.execution.mainnet.lukso.network/api"},testnet:{rpc:"https://rpc.testnet.lukso.network",indexer:"https://envio.lukso-testnet.universal.tech/v1/graphql",explorer:"https://explorer.execution.testnet.lukso.network",explorerApi:"https://explorer.execution.testnet.lukso.network/api"}};function r(e){return 42===e?"mainnet":4201===e?"testnet":null}function i(e){return n[e]}let o=t.default.env.NEXT_PUBLIC_APP_URL||"https://migrate.universaleverything.io";e.s(["APP_BASE_URL",0,o,"DEFAULT_NETWORK",0,"mainnet","ENDPOINTS",0,n,"getEndpoints",()=>i,"getNetworkFromChainId",()=>r])},63350,222665,e=>{"use strict";var t=e.i(474076),n=e.i(271645),r=e.i(612573),i=e.i(170778),o=e.i(249994),s=e.i(574253);e.i(604647);var a=e.i(609534),l=e.i(309682),c=e.i(110163),d=e.i(427795),u=e.i(558698);function h(e){return{log:(t,...n)=>{console.log(`${e} ${t}`,...n)},error:(t,...n)=>{console.error(`${e}  ${t}`,...n)},warn:(t,...n)=>{console.warn(`${e}  ${t}`,...n)},success:(t,...n)=>{console.log(`${e}  ${t}`,...n)}}}function C(){console.log("%c[UP Migration App] v11 - Debug Logging Enabled","color: #6366f1; font-weight: bold; font-size: 14px;"),console.log("%c[UP Migration App] Check console for detailed connection debugging","color: #6366f1;")}e.s(["createLogger",()=>h,"logAppStartup",()=>C],222665);let p=h("[WalletContext]");C();let m=(0,n.createContext)(null);function g(){let e=window.lukso,t=window.ethereum;return e?(p.log("detectInjectedProvider: Found window.lukso"),{hasProvider:!0,type:"lukso",provider:e}):t?(p.log("detectInjectedProvider: Found window.ethereum"),{hasProvider:!0,type:"ethereum",provider:t}):(p.log("detectInjectedProvider: No provider found"),{hasProvider:!1,type:"none",provider:null})}function f(e){let t=42===e?d.lukso:d.luksoTestnet;return(0,l.createPublicClient)({chain:t,transport:(0,c.http)()})}function w({children:l}){let{address:c,isConnected:d,isConnecting:h}=(0,r.useAccount)(),C=(0,i.useChainId)(),{disconnect:w}=(0,o.useDisconnect)(),{open:v}=(0,a.useAppKit)(),{sendTransactionAsync:E}=(0,s.useSendTransaction)(),[A,N]=(0,n.useState)(null),[y,T]=(0,n.useState)({isConnected:!1,isConnecting:!1,address:null,contextAddress:null,chainId:null}),[b,I]=(0,n.useState)(!1),[U,O]=(0,n.useState)(!1),[S,P]=(0,n.useState)(null),[k,_]=(0,n.useState)(null),[R,L]=(0,n.useState)(null),[W,M]=(0,n.useState)(!1),[F,D]=(0,n.useState)({isReady:!1,chainId:null});async function x(){p.log("=== INITIALIZATION STARTING ===");let e=function(){try{let e=window.self!==window.top;return p.log(`isInIframe: ${e}`),e}catch{return p.log("isInIframe: true (cross-origin)"),!0}}(),t=g();p.log("Environment:",{inIframe:e,...t}),I(e),O(t.hasProvider),e&&await j(),p.success("=== INITIALIZATION COMPLETE ==="),M(!0)}async function j(){try{p.log("Initializing UP Provider...");let{createClientUPProvider:t}=await e.A(867203),n=t();N(n),n.on("accountsChanged",H),n.on("contextAccountsChanged",q),n.on("chainChanged",B),await K(n)}catch(e){p.error("Failed to initialize UP Provider:",e)}}function H(e){p.log("UP Provider accountsChanged:",e?.length),e?.length>0?(p.success("Account connected:",e[0]),T(t=>({...t,isConnected:!0,isConnecting:!1,address:e[0]})),P("up-provider")):(p.warn("Accounts cleared"),T(e=>({...e,isConnected:!1,address:null})))}function q(e){p.log("UP Provider contextAccountsChanged:",e?.length),e?.length>0&&T(t=>({...t,contextAddress:e[0]}))}function B(e){let t="string"==typeof e?parseInt(e,16):e;p.log("UP Provider chainChanged:",t),T(e=>({...e,chainId:t})),L(f(t))}async function K(e){try{let t=await e.request({method:"eth_accounts"});t?.length>0&&H(t);let n=await e.request({method:"eth_chainId"});n&&B(n);try{let t=await e.request({method:"up_contextAccounts"});t?.length>0&&q(t)}catch{p.warn("up_contextAccounts not available")}}catch(e){p.warn("No initial accounts:",e)}}(0,n.useEffect)(()=>{x()},[]),(0,n.useEffect)(()=>{d&&c&&!y.isConnected&&(p.log("Wagmi connected:",c),P("walletconnect"),L(f(C)))},[d,c,C,y.isConnected]);let $=y.isConnected||d,V=y.isConnecting||h,z=y.address||c||null,G=y.chainId||C||null,Y=G?(0,u.getNetworkFromChainId)(G):null,X=F.isReady||d||y.isConnected,Q=!b&&!y.isConnected,J=(0,n.useCallback)(async e=>{switch(p.log("=== CONNECT CALLED ===",{source:e}),_(null),!e&&(e=b&&A?"up-provider":U?"injected":"walletconnect"),e){case"up-provider":await Z();break;case"injected":await ee();break;case"walletconnect":await en()}},[b,A,U,v]);async function Z(){p.log("Connecting via UP Provider"),T(e=>({...e,isConnecting:!0})),setTimeout(()=>{T(e=>e.isConnecting&&!e.isConnected?(_("Waiting for connection from Universal Everything. Please ensure you are connected."),{...e,isConnecting:!1}):e)},5e3)}async function ee(){p.log("Connecting via injected provider");let e=g();if(!e.hasProvider||!e.provider)return void _("No injected wallet found. Please install UP Browser Extension or use WalletConnect.");let t=e.provider;try{let e=await t.request({method:"eth_requestAccounts"}),n=await t.request({method:"eth_chainId"}),r=parseInt(n,16);D({isReady:!0,chainId:r}),P("injected"),L(f(r)),e?.length>0?(p.success("Connected with account:",e[0]),T({isConnected:!0,isConnecting:!1,address:e[0],contextAddress:null,chainId:r})):(p.warn("Connected but no profile address - first-time user"),T({isConnected:!1,isConnecting:!1,address:null,contextAddress:null,chainId:r}))}catch(e){if(-32001===e?.code){p.log("Error -32001: First-time user flow"),await et(t);return}p.error("Connection failed:",e),_(e instanceof Error?e.message:"Failed to connect"),D({isReady:!1,chainId:null})}}async function et(e){try{let t=await e.request({method:"eth_chainId"}),n=parseInt(t,16);D({isReady:!0,chainId:n}),P("injected"),L(f(n)),T({isConnected:!1,isConnecting:!1,address:null,contextAddress:null,chainId:n}),p.success("First-time user: Provider ready, no profile")}catch(e){p.error("Failed to get chainId:",e)}}async function en(){p.log("Connecting via WalletConnect");try{await v()}catch(e){p.error("WalletConnect failed:",e),_(e instanceof Error?e.message:"Failed to open WalletConnect")}}let er=(0,n.useCallback)(()=>{p.log("=== DISCONNECT ===",{walletSource:S}),"walletconnect"===S&&w(),T({isConnected:!1,isConnecting:!1,address:null,contextAddress:null,chainId:null}),D({isReady:!1,chainId:null}),P(null),_(null),p.success("Disconnected")},[S,w]),ei=(0,n.useCallback)(async e=>{if(!$||!z)return _("Not connected"),null;try{let t={from:z,to:e.to,data:e.data,value:e.value?`0x${e.value.toString(16)}`:"0x0"};if("up-provider"===S&&A)return await A.request({method:"eth_sendTransaction",params:[t]});if("injected"===S){let e=g().provider;if(e)return await e.request({method:"eth_sendTransaction",params:[t]})}return await E({to:e.to,data:e.data,value:e.value})}catch(e){return p.error("Transaction failed:",e),_(e instanceof Error?e.message:"Transaction failed"),null}},[$,z,S,A,E]),eo=(0,n.useCallback)(async()=>{try{await v()}catch(e){_(e instanceof Error?e.message:"Failed to open WalletConnect")}},[v]),es=(0,n.useCallback)(async e=>{let t=R||f(G??4201);try{let n=await t.getCode({address:e});return void 0!==n&&"0x"!==n}catch(e){return p.error("Error checking contract address:",e),!1}},[R,G]),ea=(0,n.useCallback)(async e=>{if(p.log("=== UP_IMPORT ===",{profileAddress:e}),A){let t=await el(A,e,"UP Provider");if(t)return t}let t=g();if(t.hasProvider&&t.provider){let n=await el(t.provider,e,"injected");if(n)return n}return p.log("up_import not available on any provider"),null},[A]);async function el(e,t,n){try{p.log(`Trying up_import via ${n}...`);let r=await e.request({method:"up_import",params:[t]});if(r&&"string"==typeof r)return p.success(`up_import succeeded (${n}):`,r),{controllerAddress:r};if(r&&"object"==typeof r&&"controllerAddress"in r)return p.success(`up_import succeeded (${n}):`,r),r;p.warn("Unexpected up_import result format:",r)}catch(e){p.warn(`up_import not available via ${n}:`,e)}return null}(0,n.useEffect)(()=>{p.log("State:",{isConnected:$,isConnecting:V,address:z,isProviderReady:X,walletSource:S,chainId:G,network:Y,error:k})},[$,V,z,X,S,G,Y,k]);let ec={isConnected:$,isConnecting:V,address:z,contextAddress:y.contextAddress,chainId:G,network:Y,error:k,walletSource:S,isInMiniAppContext:b,hasInjectedProvider:U,isProviderReady:X,publicClient:R,upProvider:A,connect:J,disconnect:er,sendTransaction:ei,requestUpImport:ea,isContractAddress:es,openWalletConnect:eo,shouldShowWalletConnect:Q};return W?(0,t.jsx)(m.Provider,{value:ec,children:l}):null}function v(){let e=(0,n.useContext)(m);if(!e)throw Error("useWallet must be used within WalletContextProvider");return e}e.s(["WalletContextProvider",()=>w,"useWallet",()=>v],63350)}]);